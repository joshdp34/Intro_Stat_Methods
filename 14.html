<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; Correlation and Simple Linear Regression – STA 2381 Introductory Statistical Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2ea2d3e7f2364fcda3d434693d3458e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style type="text/css">
.sidebar .chapter-number {
color: #FFB81c;
}
freeblank {
  color: transparent;
  cursor: pointer;
}
freeblank.clicked {
  color: red;
}
blank {
  display: inline-block; 
  position: relative;
  padding: 0 10px;
  color: transparent;
  cursor: pointer;
}
blank::before {
  content: ''; /* Creates a custom underline */
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 1px; /* Thickness of the underline */
  background-color: black; /* Color of the underline */
}
blank.clicked {
  color: red;
}
</style>
<script>
document.addEventListener('click', (event) => {
  if (event.target.tagName === 'BLANK') {
    event.target.classList.add('clicked');
  }
});
document.addEventListener('click', (event) => {
  if (event.target.tagName === 'FREEBLANK') {
    event.target.classList.add('clicked');
  }
});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./14.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Correlation and Simple Linear Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Collecting Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Describing Data with Tables and Graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Describing Data with Numbers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sampling Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation and Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesis Testing: The Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis Testing with Categorical Response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Methods for Quantitative Response Variables – One and Two Groups</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Correlation and Simple Linear Regression</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-14_01" id="toc-sec-14_01" class="nav-link active" data-scroll-target="#sec-14_01"><span class="header-section-number">14.1</span> Scatterplots and the Correlation Coefficient</a>
  <ul class="collapse">
  <li><a href="#measuring-linear-association" id="toc-measuring-linear-association" class="nav-link" data-scroll-target="#measuring-linear-association">Measuring linear association</a></li>
  <li><a href="#example-volume-of-lumber" id="toc-example-volume-of-lumber" class="nav-link" data-scroll-target="#example-volume-of-lumber">Example: Volume of lumber</a></li>
  <li><a href="#correlation-coefficient" id="toc-correlation-coefficient" class="nav-link" data-scroll-target="#correlation-coefficient">Correlation Coefficient</a></li>
  <li><a href="#example-age-and-systolic-blood-pressure" id="toc-example-age-and-systolic-blood-pressure" class="nav-link" data-scroll-target="#example-age-and-systolic-blood-pressure">Example: Age and systolic blood pressure</a></li>
  <li><a href="#some-examples-of-r" id="toc-some-examples-of-r" class="nav-link" data-scroll-target="#some-examples-of-r">Some Examples of <span class="math inline">\(r\)</span></a></li>
  <li><a href="#the-population-correlation-coefficient" id="toc-the-population-correlation-coefficient" class="nav-link" data-scroll-target="#the-population-correlation-coefficient">The Population Correlation Coefficient</a></li>
  <li><a href="#creating-scatterplots-and-computing-correlation-in-jmp-18" id="toc-creating-scatterplots-and-computing-correlation-in-jmp-18" class="nav-link" data-scroll-target="#creating-scatterplots-and-computing-correlation-in-jmp-18">Creating scatterplots and computing correlation in JMP 18</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#check-your-understanding" id="toc-check-your-understanding" class="nav-link" data-scroll-target="#check-your-understanding">Check your understanding</a></li>
  </ul></li>
  <li><a href="#sec-14_02" id="toc-sec-14_02" class="nav-link" data-scroll-target="#sec-14_02"><span class="header-section-number">14.2</span> Least Squares Regression Line</a>
  <ul class="collapse">
  <li><a href="#fitting-the-model-the-method-of-least-squares" id="toc-fitting-the-model-the-method-of-least-squares" class="nav-link" data-scroll-target="#fitting-the-model-the-method-of-least-squares">Fitting the Model: The Method of Least Squares</a></li>
  <li><a href="#example-advertising-and-sales-business" id="toc-example-advertising-and-sales-business" class="nav-link" data-scroll-target="#example-advertising-and-sales-business">Example: Advertising and sales (business)</a></li>
  <li><a href="#performing-regression-in-jmp-18" id="toc-performing-regression-in-jmp-18" class="nav-link" data-scroll-target="#performing-regression-in-jmp-18">Performing regression in JMP 18</a></li>
  <li><a href="#recap-1" id="toc-recap-1" class="nav-link" data-scroll-target="#recap-1">Recap</a></li>
  <li><a href="#check-your-understanding-1" id="toc-check-your-understanding-1" class="nav-link" data-scroll-target="#check-your-understanding-1">Check your understanding</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Correlation and Simple Linear Regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-14_01" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="sec-14_01"><span class="header-section-number">14.1</span> Scatterplots and the Correlation Coefficient</h2>
<blockquote class="blockquote">
<p>“The modern student, and too often his teacher, overlook the fact that such a simple thing as a scatter diagram is a more important tool of prediction than the correlation coefficient…” – W. Edwards Deming</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>How do we visualize and measure the strength and direction of a linear relationship between two quantitative variables?</em></p>
</blockquote>
<p>When exploring two numerical variables, the first step is to look at the variables graphically. A <blank>scatterplot</blank> is simply a collection of points in the plane where each point represents one observation. We usually plot the explanatory variable on the horizontal axis and the response variable on the vertical axis. If you are unsure which variable should go on which axis, it often does not matter for descriptive purposes, but if your goal is prediction you should place the variable you wish to predict on the vertical axis.</p>
<p>Scatterplots reveal patterns that numbers alone cannot. If the points lie cluster around a straight line, the relationship is approximately <blank>linear</blank>. If the points form a curved band, the association is nonlinear. The closer the points are to a straight line, the stronger the linear relationship. Outliers can distort our impression, so always scan the plot before jumping into calculations.</p>
<section id="measuring-linear-association" class="level3">
<h3 class="anchored" data-anchor-id="measuring-linear-association">Measuring linear association</h3>
<p>To quantify the strength and direction of a linear relationship we use the <blank>correlation coefficient</blank>.</p>
<p>It is computed as <span class="math display">\[
\begin{align*}
    {r=\frac{SS_{xy}}{\sqrt{SS_{xx}SS_{yy}}}}
\end{align*}
\]</span> where <span class="math display">\[
\begin{align*}
SS_{xy} =&amp; \sum \left(y_i-\bar{y}\right)\left(x_i-\bar{x}\right)\\
SS_{xx} =&amp; \sum \left(x_i-\bar{x}\right)^2\\
SS_{yy} =&amp; \sum \left(y_i-\bar{y}\right)^2
\end{align*}
\]</span></p>
<p><span class="math inline">\(SS_{xx}\)</span> and <span class="math inline">\(SS_{yy}\)</span> are measures of <em>variability</em> of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, respectively. That is, they indicate how <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> varies about their mean, individually.</p>
<p><span class="math inline">\(SS_{xy}\)</span> is a measure of how <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> vary <em>together</em>.</p>
<p>For example, consider the data in the scatterplot below. The two red lines represent the mean of the <span class="math inline">\(x\)</span> variable (the vertical red line is for <span class="math inline">\(\bar{x}\)</span>) and the mean of the <span class="math inline">\(y\)</span> variable (the horizontal red line is for <span class="math inline">\(\bar{y}\)</span>).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Let’s find <span class="math inline">\(SS_{xx}\)</span>, <span class="math inline">\(SS_{yy}\)</span>, and <span class="math inline">\(SS_{xy}\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(x\)</span></th>
<th style="text-align: right;"><span class="math inline">\(y\)</span></th>
<th style="text-align: right;"><span class="math inline">\((x - \bar{x})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y - \bar{y})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((x - \bar{x})(y - \bar{y})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">16.7587891</td>
<td style="text-align: right;">0.8441016</td>
<td style="text-align: right;">-3.7611328</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">9.5712891</td>
<td style="text-align: right;">0.1016016</td>
<td style="text-align: right;">-0.9861328</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">5.4931641</td>
<td style="text-align: right;">0.2691016</td>
<td style="text-align: right;">-1.2158203</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.1962891</td>
<td style="text-align: right;">0.0284766</td>
<td style="text-align: right;">-0.1845703</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.8212891</td>
<td style="text-align: right;">0.0066016</td>
<td style="text-align: right;">-0.0736328</td>
</tr>
<tr class="even">
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">3.6337891</td>
<td style="text-align: right;">0.3378516</td>
<td style="text-align: right;">-1.1080078</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.00</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">8.4462891</td>
<td style="text-align: right;">0.3378516</td>
<td style="text-align: right;">-1.6892578</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">24.0712891</td>
<td style="text-align: right;">0.4641016</td>
<td style="text-align: right;">-3.3423828</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that each value in <span class="math inline">\((x_i-\bar{x})(y_i-\bar{y})\)</span> is negative. This is because as <span class="math inline">\(x\)</span> is below <span class="math inline">\(\bar{x}\)</span>, <span class="math inline">\(y\)</span> is above <span class="math inline">\(\bar{y}\)</span>. Likewise, as <span class="math inline">\(x\)</span> is above <span class="math inline">\(\bar{x}\)</span>, <span class="math inline">\(y\)</span> is below <span class="math inline">\(\bar{y}\)</span>. In the scatterplot above, you can see how the observations are below or above these lines.</p>
<p>Summing up the values give us: <span class="math display">\[
\begin{align*}
SS_{xx} =&amp; \sum \left(x_i-\bar{x}\right)^2\\
= &amp; 69.9921875\\\\
SS_{yy} =&amp; \sum \left(y_i-\bar{y}\right)^2\\
= &amp; 2.3896875\\\\
SS_{xy} =&amp; \sum \left(y_i-\bar{y}\right)\left(x_i-\bar{x}\right)\\
= &amp; -12.3609375
\end{align*}
\]</span></p>
</section>
<section id="example-volume-of-lumber" class="level3">
<h3 class="anchored" data-anchor-id="example-volume-of-lumber">Example: Volume of lumber</h3>
<p>In the following scatterplot, the volume of timber from 31 black cherry trees are plotted against the diamter of the tree measured at 54 inches off the ground.</p>
<p>Again, we plot the data with red lines representing <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(x\)</span></th>
<th style="text-align: right;"><span class="math inline">\(y\)</span></th>
<th style="text-align: right;"><span class="math inline">\((x - \bar{x})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((y - \bar{y})^2\)</span></th>
<th style="text-align: right;"><span class="math inline">\((x - \bar{x})(y - \bar{y})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">8.3</td>
<td style="text-align: right;">10.3</td>
<td style="text-align: right;">24.4865349</td>
<td style="text-align: right;">394.855359</td>
<td style="text-align: right;">98.3292404</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.6</td>
<td style="text-align: right;">10.3</td>
<td style="text-align: right;">21.6075026</td>
<td style="text-align: right;">394.855359</td>
<td style="text-align: right;">92.3679501</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.8</td>
<td style="text-align: right;">10.2</td>
<td style="text-align: right;">19.7881478</td>
<td style="text-align: right;">398.839553</td>
<td style="text-align: right;">88.8385952</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">16.4</td>
<td style="text-align: right;">7.5536316</td>
<td style="text-align: right;">189.639553</td>
<td style="text-align: right;">37.8479501</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10.7</td>
<td style="text-align: right;">18.8</td>
<td style="text-align: right;">6.4942768</td>
<td style="text-align: right;">129.298907</td>
<td style="text-align: right;">28.9776275</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.8</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">5.9945994</td>
<td style="text-align: right;">109.641165</td>
<td style="text-align: right;">25.6369823</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">15.6</td>
<td style="text-align: right;">5.0552445</td>
<td style="text-align: right;">212.313101</td>
<td style="text-align: right;">32.7611759</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">18.2</td>
<td style="text-align: right;">5.0552445</td>
<td style="text-align: right;">143.304069</td>
<td style="text-align: right;">26.9153694</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.1</td>
<td style="text-align: right;">22.6</td>
<td style="text-align: right;">4.6155671</td>
<td style="text-align: right;">57.319553</td>
<td style="text-align: right;">16.2653694</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.2</td>
<td style="text-align: right;">19.9</td>
<td style="text-align: right;">4.1958897</td>
<td style="text-align: right;">105.492778</td>
<td style="text-align: right;">21.0389178</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.3</td>
<td style="text-align: right;">24.2</td>
<td style="text-align: right;">3.7962123</td>
<td style="text-align: right;">35.652456</td>
<td style="text-align: right;">11.6337565</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">3.4165349</td>
<td style="text-align: right;">84.106649</td>
<td style="text-align: right;">16.9514984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11.4</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">3.4165349</td>
<td style="text-align: right;">76.929875</td>
<td style="text-align: right;">16.2121436</td>
</tr>
<tr class="even">
<td style="text-align: right;">11.7</td>
<td style="text-align: right;">21.3</td>
<td style="text-align: right;">2.3975026</td>
<td style="text-align: right;">78.694069</td>
<td style="text-align: right;">13.7356920</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">19.1</td>
<td style="text-align: right;">1.5584703</td>
<td style="text-align: right;">122.566327</td>
<td style="text-align: right;">13.8208533</td>
</tr>
<tr class="even">
<td style="text-align: right;">12.9</td>
<td style="text-align: right;">22.2</td>
<td style="text-align: right;">0.1213736</td>
<td style="text-align: right;">63.536327</td>
<td style="text-align: right;">2.7769823</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.9</td>
<td style="text-align: right;">33.8</td>
<td style="text-align: right;">0.1213736</td>
<td style="text-align: right;">13.169875</td>
<td style="text-align: right;">-1.2643080</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.3</td>
<td style="text-align: right;">27.4</td>
<td style="text-align: right;">0.0026639</td>
<td style="text-align: right;">7.678262</td>
<td style="text-align: right;">-0.1430177</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13.7</td>
<td style="text-align: right;">25.7</td>
<td style="text-align: right;">0.2039542</td>
<td style="text-align: right;">19.989552</td>
<td style="text-align: right;">-2.0191467</td>
</tr>
<tr class="even">
<td style="text-align: right;">13.8</td>
<td style="text-align: right;">24.9</td>
<td style="text-align: right;">0.3042768</td>
<td style="text-align: right;">27.783101</td>
<td style="text-align: right;">-2.9075338</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.0</td>
<td style="text-align: right;">34.5</td>
<td style="text-align: right;">0.5649220</td>
<td style="text-align: right;">18.740520</td>
<td style="text-align: right;">3.2537565</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.2</td>
<td style="text-align: right;">31.7</td>
<td style="text-align: right;">0.9055671</td>
<td style="text-align: right;">2.337940</td>
<td style="text-align: right;">1.4550468</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.5</td>
<td style="text-align: right;">36.3</td>
<td style="text-align: right;">1.5665349</td>
<td style="text-align: right;">37.565036</td>
<td style="text-align: right;">7.6711759</td>
</tr>
<tr class="even">
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">38.3</td>
<td style="text-align: right;">7.5713736</td>
<td style="text-align: right;">66.081165</td>
<td style="text-align: right;">22.3679501</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16.3</td>
<td style="text-align: right;">42.6</td>
<td style="text-align: right;">9.3123413</td>
<td style="text-align: right;">154.480843</td>
<td style="text-align: right;">37.9285952</td>
</tr>
<tr class="even">
<td style="text-align: right;">17.3</td>
<td style="text-align: right;">55.4</td>
<td style="text-align: right;">16.4155671</td>
<td style="text-align: right;">636.504069</td>
<td style="text-align: right;">102.2182726</td>
</tr>
<tr class="odd">
<td style="text-align: right;">17.5</td>
<td style="text-align: right;">55.7</td>
<td style="text-align: right;">18.0762123</td>
<td style="text-align: right;">651.731488</td>
<td style="text-align: right;">108.5395630</td>
</tr>
<tr class="even">
<td style="text-align: right;">17.9</td>
<td style="text-align: right;">58.3</td>
<td style="text-align: right;">21.6375026</td>
<td style="text-align: right;">791.242456</td>
<td style="text-align: right;">130.8453694</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">51.5</td>
<td style="text-align: right;">22.5778252</td>
<td style="text-align: right;">454.927617</td>
<td style="text-align: right;">101.3473049</td>
</tr>
<tr class="even">
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">51.0</td>
<td style="text-align: right;">22.5778252</td>
<td style="text-align: right;">433.848585</td>
<td style="text-align: right;">98.9714984</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20.6</td>
<td style="text-align: right;">77.0</td>
<td style="text-align: right;">54.0462123</td>
<td style="text-align: right;">2192.958262</td>
<td style="text-align: right;">344.2689178</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In this example, most of the observations have <span class="math inline">\((x-\bar{x})(y-\bar{y})\)</span> that are positive. This is because these observations have values of <span class="math inline">\(x\)</span> that are below <span class="math inline">\(\bar{x}\)</span> and values of <span class="math inline">\(y\)</span> that are below <span class="math inline">\(\bar{y}\)</span>, or values of <span class="math inline">\(x\)</span> that are above <span class="math inline">\(\bar{x}\)</span> and values of <span class="math inline">\(y\)</span> that are above <span class="math inline">\(\bar{y}\)</span>.</p>
<p>There are four observations that have a negative value of <span class="math inline">\((x-\bar{x})(y-\bar{y})\)</span>. Although they are negative, the value of <span class="math inline">\(SS_{xy}\)</span> is positive due to all the observations with positive values of <span class="math inline">\((x-\bar{x})(y-\bar{y})\)</span>. Therefore, we say if <span class="math inline">\(SS_{xy}\)</span> is <blank>positive</blank>, then <span class="math inline">\(y\)</span> tends to increase as <span class="math inline">\(x\)</span> increases. Likewise, if <span class="math inline">\(SS_{xy}\)</span> is <blank>negative</blank>, then <span class="math inline">\(y\)</span> tends to decrease as <span class="math inline">\(x\)</span> increases.</p>
<p>If <span class="math inline">\(SS_{xy}\)</span> is zero (or close to zero), then we say <span class="math inline">\(y\)</span> does not tend to change as <span class="math inline">\(x\)</span> increases.</p>
</section>
<section id="correlation-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="correlation-coefficient">Correlation Coefficient</h3>
<p>We first note that <span class="math inline">\(SS_{xy}\)</span> cannot be greater in absolute value than the quantity <span class="math display">\[
\sqrt{SS_{xx}SS_{yy}}
\]</span> We will not prove this here, but it is a direct application of the Cauchy-Schwarz inequality .</p>
<p>Thus, the correlation coefficient <span class="math display">\[
\begin{align}
    r=\frac{SS_{xy}}{\sqrt{SS_{xx}SS_{yy}}}
\end{align}
\]</span> is a value sucha that <span class="math display">\[
-1\le r \le 1
\]</span></p>
<p>If <span class="math inline">\(r=0\)</span>, then there is no linear relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>If <span class="math inline">\(r\)</span> is positive, then the slope of the linear relationship is positive. If <span class="math inline">\(r\)</span> is negative, then the slope of the linear relationship is negative.</p>
<p>The closer <span class="math inline">\(r\)</span> is to one in absolute value, the stronger the linear relationship is between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p>Because it is based on means and standard deviations, Pearson’s <span class="math inline">\(r\)</span> is sensitive to outliers and assumes the data are reasonably normal. When one or both variables are non‑normal, a rank‑based measure such as Spearman’s rho may be used instead (not discussed in this course).</p>
<p>It is tempting to interpret a large correlation as evidence of <blank>causation</blank>, but correlation merely quantifies association. Even a strong correlation can arise from confounding variables or chance. Always consider the context and remember that a scatterplot and subject‑matter knowledge are essential for interpretation.</p>
</section>
<section id="example-age-and-systolic-blood-pressure" class="level3">
<h3 class="anchored" data-anchor-id="example-age-and-systolic-blood-pressure">Example: Age and systolic blood pressure</h3>
<p>To see how scatterplots and correlation work in practice, consider a small study of 20 adults ranging in age from 30 to 80 years. The response variable is systolic blood pressure (measured in mm Hg). The scatterplot below shows the relationship.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The cloud of points slopes upward, indicating a positive relationship: older participants tend to have higher systolic blood pressure. The correlation coefficient for this dataset is about 0.93, suggesting a strong positive linear association.</p>
</section>
<section id="some-examples-of-r" class="level3">
<h3 class="anchored" data-anchor-id="some-examples-of-r">Some Examples of <span class="math inline">\(r\)</span></h3>
<p>The best way to grasp correlation is to see examples. In <a href="#fig-05_01" class="quarto-xref">Figure&nbsp;<span>14.1</span></a>, scatterplots of 200 observations are shown with a least squares line.</p>
<div id="fig-05_01" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-05_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-05_01" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-05_01a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-05_01a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/fig_02_04_01a.png" class="img-fluid figure-img" data-ref-parent="fig-05_01">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-05_01a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <span class="math inline">\(r=-0.079\)</span>
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-05_01" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-05_01b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-05_01b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/fig_02_04_01b.png" class="img-fluid figure-img" data-ref-parent="fig-05_01">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-05_01b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) <span class="math inline">\(r=-0.672\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-05_01" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-05_01c" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-05_01c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/fig_02_04_01c.png" class="img-fluid figure-img" data-ref-parent="fig-05_01">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-05_01c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) <span class="math inline">\(r=0.723\)</span>
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-05_01" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-05_01d" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-05_01d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/fig_02_04_01d.png" class="img-fluid figure-img" data-ref-parent="fig-05_01">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-05_01d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) <span class="math inline">\(r=0.524\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-05_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.1: Examples of correlation
</figcaption>
</figure>
</div>
<p>Note how the value of <span class="math inline">\(r\)</span> relates to how spread out the points are from the line as well as to the slope of the line.</p>
</section>
<section id="the-population-correlation-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="the-population-correlation-coefficient">The Population Correlation Coefficient</h3>
<p>The correlation <span class="math inline">\(r\)</span> is for the observed data which is usually from a sample. Thus, <span class="math inline">\(r\)</span> is the <em>sample</em> correlation coefficient.</p>
<p>We could make a hypothesis about the correlation of the <em>population</em> based on the sample. We will denote the population correlation with <span class="math inline">\(\rho\)</span>. The hypothesis we will want to test is <span class="math display">\[
\begin{align*}
  H_0:\rho = 0\\
H_a:\rho \ne 0
\end{align*}
\]</span></p>
<p>The test statistic is <span class="math display">\[
\begin{align}
t &amp; =\frac{r\sqrt{\left(n-2\right)}}{\sqrt{1-r^{2}}}
\end{align}
\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true, then <span class="math inline">\(t\)</span> will have a Student’s <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-2\)</span> degrees of freedom.</p>
</section>
<section id="creating-scatterplots-and-computing-correlation-in-jmp-18" class="level3">
<h3 class="anchored" data-anchor-id="creating-scatterplots-and-computing-correlation-in-jmp-18">Creating scatterplots and computing correlation in JMP 18</h3>
<p>JMP makes it easy to explore the relationship between two quantitative variables:</p>
<ul>
<li><strong>Create a scatterplot.</strong> Load your data into a JMP table. Choose <strong>Graph → Graph Builder</strong>, drag the explanatory variable to the X‑axis and the response variable to the Y‑axis, and select the <em>Scatter Plot</em> element. You can add a fitted line by clicking the blue triangle next to <strong>Fit Line</strong>.</li>
<li><strong>Compute the correlation.</strong> Choose <strong>Analyze → Multivariate Methods → Multivariate</strong>. Select your variables and click <strong>Y, Columns</strong>. JMP displays a matrix of scatterplots and gives the Pearson correlation coefficient in the correlation table. If normality is questionable, use <strong>Analyze → Multivariate → Nonparametric Correlations</strong> for Spearman’s rho.</li>
</ul>
</section>
<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword/Concept</strong></th>
<th><strong>Explanation</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>scatterplot</strong></td>
<td>A graph of paired quantitative data where each point represents one observation; used to visualize the relationship between two variables.</td>
</tr>
<tr class="even">
<td><strong>Pearson’s correlation coefficient (r)</strong></td>
<td>A measure of the strength and direction of a linear relationship, ranging from −1 to +1; positive values indicate direct association and negative values indicate inverse association.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding">Check your understanding</h3>
<ol type="1">
<li>A study of 30 students reports a correlation of <span class="math inline">\(r=0.85\)</span> between hours studied and exam score. What does this value tell you about the relationship? Would you conclude that studying more <em>causes</em> higher scores? Explain.</li>
<li>Sketch (or describe) how a scatterplot would look if <span class="math inline">\(r\approx -0.6\)</span>. What does the sign and magnitude of this correlation tell you about the relationship?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>The correlation of 0.85 indicates a strong positive linear association: students who study more tend to score higher. However, correlation on its own does not prove causation. Other factors (prior knowledge, test difficulty) may influence scores, and experimental control would be needed to establish a causal link.</li>
<li>A correlation of <span class="math inline">\(-0.6\)</span> produces a downward‑sloping cloud of points: as one variable increases, the other tends to decrease. The moderate magnitude (0.6) suggests a reasonably strong inverse relationship but with noticeable scatter around a straight line.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-14_02" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="sec-14_02"><span class="header-section-number">14.2</span> Least Squares Regression Line</h2>
<blockquote class="blockquote">
<p>“Regression. It is a universal rule that the unknown kinsman in any degree of any specified man, is probably more mediocre than he.” – Francis Galton</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>How can we use a straight line to make predictions and what makes one line better than another?</em></p>
</blockquote>
<p>After visualizing and quantifying the relationship between two variables, the next step is to model that relationship. In <strong>simple linear regression</strong>, we seek the line that best predicts the response variable <span class="math inline">\(y\)</span> from the explanatory variable <span class="math inline">\(x\)</span>. The model has the form <span class="math display">\[
\begin{align*}
y = \beta_0 + \beta_1 x+\varepsilon
\end{align*}
\]</span> where:</p>
<ul>
<li><span class="math inline">\(y\)</span> is the response variable (also known as the <blank>dependent</blank> variable)</li>
<li><span class="math inline">\(x\)</span> is the predictor variable (also called the <blank>independent</blank> variable or explanatory variable)</li>
<li><span class="math inline">\(\varepsilon\)</span> is the <em>random error</em> component</li>
<li><span class="math inline">\(\beta_0\)</span> is the <em>y-intercept</em> of the line (the point where the line intersects the y-axis)</li>
<li><span class="math inline">\(\beta_1\)</span> is the <em>slope</em> of the line (the change in the mean of <span class="math inline">\(y\)</span> for every 1-unit increase in <span class="math inline">\(x\)</span>)</li>
</ul>
<p>We use Greek symbols <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> to denote the y-intercept and slope of the line. These are population <em>parameters</em> with values that would only be known if we had access to the entire population of <span class="math inline">\((x, y)\)</span> measurements.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Review: Greek Letters in Notation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Usually, in Statistics, lower-case Greek letters are used to denote population parameters. In our model above, we have an exception. The Greek letter <span class="math inline">\(\varepsilon\)</span> is not a parameter, but a random variable (parameters are not random variables in frequentist statistics).</p>
</div>
</div>
<section id="fitting-the-model-the-method-of-least-squares" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model-the-method-of-least-squares">Fitting the Model: The Method of Least Squares</h3>
<p>Suppose we have the data shown in <a href="#tbl-table2_1" class="quarto-xref">Table&nbsp;<span>14.1</span></a> below and plotted in the scatterplot in <a href="#fig-2_1" class="quarto-xref">Figure&nbsp;<span>14.2</span></a>.</p>
<div id="tbl-table2_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-table2_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;14.1: Data for Scatterplot
</figcaption>
<div aria-describedby="tbl-table2_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>2</td>
<td>1.4</td>
</tr>
<tr class="odd">
<td>2.75</td>
<td>1.6</td>
</tr>
<tr class="even">
<td>4</td>
<td>1.25</td>
</tr>
<tr class="odd">
<td>6</td>
<td>1</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.5</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.5</td>
</tr>
<tr class="even">
<td>10</td>
<td>0.4</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2_1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_files/figure-html/fig-2_1-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2_1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.2: Scatterplot of the data in <a href="#tbl-table2_1" class="quarto-xref">Table&nbsp;<span>14.1</span></a>
</figcaption>
</figure>
</div>
</div>
</div>
<p>We hypothesize that a straight-line model relates <em>y</em> to <em>x</em>, as follows:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x + \varepsilon
\]</span></p>
<p>How can we use the data from the eight observations in <a href="#tbl-table2_1" class="quarto-xref">Table&nbsp;<span>14.1</span></a> to estimate the unknown y-intercept (<span class="math inline">\(\beta_0\)</span>) and slope (<span class="math inline">\(\beta_1\)</span>)?</p>
<p>We can start by trying some lines and see how well they fit the data. But how do we measure how well a line <em>fits</em> the data?</p>
<p>A quantitative method to evaluate how well a straight line fits a set of data is by measuring the deviations of the data points from the line.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Review: Deviations of Response Variable
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(y\)</span> is the variable of interest, so we are focused on the differences between observed <span class="math inline">\(y\)</span> and the predicted value of <span class="math inline">\(y\)</span></p>
</div>
</div>
<p>We calculate the magnitude of the <em>deviations</em> (the differences between observed and predicted values of <span class="math inline">\(y\)</span>).</p>
<p>These deviations, or prediction errors, represent the <em>vertical</em> distances between observed and predicted values of <span class="math inline">\(y\)</span>.</p>
<p>Suppose we try to fit the line <span id="eq-02_01"><span class="math display">\[
    \hat{y} =2-.2x
\tag{14.1}\]</span></span></p>
<p>This line can be seen in <a href="#fig-2_2" class="quarto-xref">Figure&nbsp;<span>14.3</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_files/figure-html/fig-2_2-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.3: Scatterplot of data in <a href="#tbl-table2_1" class="quarto-xref">Table&nbsp;<span>14.1</span></a> with the red line representing the line in <a href="#eq-02_01" class="quarto-xref">Equation&nbsp;<span>14.1</span></a>
</figcaption>
</figure>
</div>
</div>
</div>
<p>The observed and predicted values of <span class="math inline">\(y\)</span>, their differences, and their squared differences are shown in the table below.</p>
<div id="tbl-table2_2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-table2_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;14.2: Deviations and squared deviations of the line in <a href="#eq-02_01" class="quarto-xref">Equation&nbsp;<span>14.1</span></a> and the data in <a href="#tbl-table2_1" class="quarto-xref">Table&nbsp;<span>14.1</span></a>.
</figcaption>
<div aria-describedby="tbl-table2_2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th><span class="math inline">\(y\)</span></th>
<th><span class="math inline">\(\hat{y}\)</span></th>
<th><span class="math inline">\((y - \hat{y})\)</span></th>
<th><span class="math inline">\((y - \hat{y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>1.8</td>
<td>0.2</td>
<td>0.004</td>
</tr>
<tr class="even">
<td>2</td>
<td>1.4</td>
<td>1.6</td>
<td>-0.2</td>
<td>0.004</td>
</tr>
<tr class="odd">
<td>2.75</td>
<td>1.6</td>
<td>1.45</td>
<td>0.15</td>
<td>0.0225</td>
</tr>
<tr class="even">
<td>4</td>
<td>1.25</td>
<td>1.2</td>
<td>0.05</td>
<td>0.0025</td>
</tr>
<tr class="odd">
<td>6</td>
<td>1</td>
<td>0.8</td>
<td>0.2</td>
<td>0.04</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.5</td>
<td>0.6</td>
<td>-0.1</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.5</td>
<td>0.4</td>
<td>0.1</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>10</td>
<td>0.4</td>
<td>0</td>
<td>0.4</td>
<td>0.16</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Note that the sum of the errors (SE) is 0.8, and the <em>sum</em> of <em>squares</em> of the <em>errors</em> (SSE), which emphasizes larger deviations from the line, is 0.325.</p>
<p>We can try another line to see if we do better at predicting <span class="math inline">\(y\)</span> (that is, have smaller SSE).</p>
<p>Let’s try the line <span id="eq-02_02"><span class="math display">\[
    \hat{y} =1.8-.15x
\tag{14.2}\]</span></span></p>
<p>This line can be seen in <a href="#fig-2_3" class="quarto-xref">Figure&nbsp;<span>14.4</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-2_3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2_3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_files/figure-html/fig-2_3-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2_3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.4: Scatterplot of data in <a href="#tbl-table2_1" class="quarto-xref">Table&nbsp;<span>14.1</span></a> with the red line representing the line in <a href="#eq-02_02" class="quarto-xref">Equation&nbsp;<span>14.2</span></a>
</figcaption>
</figure>
</div>
</div>
</div>
<p>The fit results are shown in <a href="#tbl-table2_3" class="quarto-xref">Table&nbsp;<span>14.3</span></a>.</p>
<div id="tbl-table2_3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-table2_3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;14.3: Deviations and squared deviations of the line in <a href="#eq-02_02" class="quarto-xref">Equation&nbsp;<span>14.2</span></a> and the data in <a href="#tbl-table2_1" class="quarto-xref">Table&nbsp;<span>14.1</span></a>.
</figcaption>
<div aria-describedby="tbl-table2_3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th><span class="math inline">\(y\)</span></th>
<th><span class="math inline">\(\hat{y}\)</span></th>
<th><span class="math inline">\(y - \hat{y}\)</span></th>
<th><span class="math inline">\((y - \hat{y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>1.65</td>
<td>0.35</td>
<td>0.1225</td>
</tr>
<tr class="even">
<td>2</td>
<td>1.4</td>
<td>1.5</td>
<td>-0.1</td>
<td>0.01</td>
</tr>
<tr class="odd">
<td>2.75</td>
<td>1.6</td>
<td>1.3875</td>
<td>0.2125</td>
<td>0.04515625</td>
</tr>
<tr class="even">
<td>4</td>
<td>1.25</td>
<td>1.2</td>
<td>0.05</td>
<td>0.0025</td>
</tr>
<tr class="odd">
<td>6</td>
<td>1</td>
<td>0.9</td>
<td>0.1</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>7</td>
<td>0.5</td>
<td>0.75</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="odd">
<td>8</td>
<td>0.5</td>
<td>0.6</td>
<td>-0.1</td>
<td>0.01</td>
</tr>
<tr class="even">
<td>10</td>
<td>0.4</td>
<td>0.3</td>
<td>0.1</td>
<td>0.01</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The SSE for this line is 0.2727, which is lower than the SSE for the previous line, indicating a better fit.</p>
<p>While we could try additional lines to achieve a lower SSE, there are infinitely many possibilities since <em><span class="math inline">\(\beta_0\)</span></em> and <em><span class="math inline">\(\beta_1\)</span></em> can take any real value.</p>
<p>Using Calculus, we can attempt to minimize the SSE for the generic line <span class="math display">\[\begin{align*}
    \hat{y} = b_0 +b_1 x
\end{align*}\]</span></p>
<p>We will denote the sum of the squared distances with <span class="math inline">\(Q\)</span>: <span id="eq-w1_2"><span class="math display">\[
Q=\sum \left(y_i-\hat{y}_i\right)^2
\tag{14.3}\]</span></span></p>
<p>We determine the “best” line as the one that minimizes <span class="math inline">\(Q\)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
For those who want to see the math:
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To minimize <span class="math inline">\(Q\)</span>, we differentiate it with respect to <span class="math inline">\(b_{0}\)</span> and <span class="math inline">\(b_{1}\)</span>: <span class="math display">\[\begin{align*}
\frac{\partial Q}{\partial b_{0}} &amp; =-2\sum \left(y_{i}-\left(b_{0}+b_{1}x_{i}\right)\right)\\
\frac{\partial Q}{\partial b_{1}} &amp; =-2\sum x_{i}\left(y_{i}-\left(b_{0}+b_{1}x_{i}\right)\right)
\end{align*}\]</span></p>
<p>Setting these partial derivatives equal to 0, we have <span class="math display">\[\begin{align*}
-2\sum \left(y_{i}-\left(b_{0}+b_{1}x_{i}\right)\right) &amp; =0\\
-2\sum x_{i}\left(y_{i}-\left(b_{0}+b_{1}x_{i}\right)\right) &amp; =0
\end{align*}\]</span> Looking at the first equation, we can simplify as <span class="math display">\[\begin{align*}
-2\sum \left(y_{i}-\left(b_{0}+b_{1}x_{i}\right)\right)=0 &amp; \Longrightarrow\sum \left(y_{i}-\left(b_{0}+b_{1}x_{i}\right)\right)=0\\
&amp; \Longrightarrow\sum y_{i}-\sum b_{0}-b_{1}\sum x_{i}=0\\
&amp; \Longrightarrow\sum y_{i}-nb_{0}-b_{1}\sum x_{i}=0\\
&amp; \Longrightarrow\sum y_{i}=nb_{0}+b_{1}\sum x_{i}
\end{align*}\]</span></p>
<p>Simplifying the second equation gives us <span class="math display">\[\begin{align*}
-2\sum x_{i}\left(y_{i}-\left(b_0+b_1x_{i}\right)\right)=0 &amp; \Longrightarrow\sum x_{i}\left(y_{i}-\left(b_0+b_1x_{i}\right)\right)=0\\
&amp; \Longrightarrow\sum x_{i}y_{i}-b_0\sum x_{i}-b_1\sum x_{i}^{2}=0\\
&amp; \Longrightarrow\sum x_{i}y_{i}=b_0\sum x_{i}+b_1\sum x_{i}^{2}
\end{align*}\]</span></p>
<p>The two equations <span id="eq-w1_3"><span class="math display">\[
\begin{align}
\sum y_{i} &amp; =nb_0+b_1\sum x_{i}\nonumber\\
\sum x_{i}y_{i} &amp; =b_0\sum x_{i}+b_1\sum x_{i}^{2}
\end{align}
\tag{14.4}\]</span></span></p>
<p>are called the <em>normal</em> <em>equations</em>.</p>
<p>We now have two equations and two unknowns (<span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>). We can solve the equations simultaneously. We solve the first equation for <span class="math inline">\(b_0\)</span> which gives us <span class="math display">\[\begin{align*}
b_0 &amp; =\frac{1}{n}\left(\sum y_{i}-b_1\sum x_{i}\right)\\
&amp; =\bar{y}-b_1\bar{x}.
\end{align*}\]</span></p>
<p>We now substitute this into the second equation in <a href="#eq-w1_3" class="quarto-xref">Equation&nbsp;<span>14.4</span></a>. Solving this for <span class="math inline">\(b_1\)</span> gives us <span class="math display">\[\begin{align*}
&amp; \sum x_{i}y_{i}=b_0\sum x_{i}+b_1\sum x_{i}^{2}\\
&amp; \quad\Longrightarrow\sum x_{i}y_{i}=\left(\bar{y}-b_1\bar{x}\right)\sum x_{i}+b_1\sum x_{i}^{2}\\
&amp;\quad\Longrightarrow b_1=\frac{\sum \left(x_{i}-\bar{x}\right)\left(y_{i}-\bar{y}\right)}{\sum \left(x_{i}-\bar{x}\right)^{2}}.
\end{align*}\]</span></p>
<p>To show these estimators are the minimum, we take the second partial derivatives of <span class="math inline">\(Q\)</span>: <span class="math display">\[\begin{align*}
\frac{\partial^{2}Q}{\partial\left(b_{0}\right)^{2}} &amp; =2n\\
\frac{\partial^{2}Q}{\partial\left(b_{1}\right)^{2}} &amp; =2\sum x_{i}^{2}
\end{align*}\]</span> Since these second partial derivatives are both positives, then we know the least squares estimators are the minimum.</p>
</div>
</div>
</div>
<p>The line that best fits the data (that is minimizes <span class="math inline">\(Q\)</span> above) has the following y-intercept and slope: <span id="eq-w1_4"><span class="math display">\[
\begin{align}
b_0 &amp; =\bar{y}-b_1\bar{x}\\
b_1 &amp; =\frac{\sum \left(x_{i}-\bar{x}\right)\left(y_{i}-\bar{y}\right)}{\sum \left(x_{i}-\bar{x}\right)^{2}}
\end{align}
\tag{14.5}\]</span></span></p>
<p>These equations are called the <blank>least squares</blank> estimators.</p>
<p>The least squares estimators in <a href="#eq-w1_4" class="quarto-xref">Equation&nbsp;<span>14.5</span></a> can be expressed in simpler terms if we let <span class="math display">\[\begin{align*}
SS_{xx} &amp;= \sum \left(x_i-\bar x\right)^2 \\
SS_{xy} &amp;= \sum \left(x_i-\bar x\right)\left(y_i - \bar y\right)
\end{align*}\]</span></p>
<p>The least squares estimates become <span class="math display">\[\begin{align}
{b_1=\frac{SS_{xy}}{SS_{xx}}}\\
{b_0=\bar{y}-b_1\bar{x}}
\end{align}\]</span></p>
<p>To recap: The straight line model for the response <span class="math inline">\(y\)</span> in terms of <span class="math inline">\(x\)</span> is <span class="math display">\[\begin{align*}
{y = \beta_0 + \beta_1 x + \varepsilon}
\end{align*}\]</span></p>
<p>The fitted line (also called the <em>least squares line</em>) is <span class="math display">\[\begin{align*}
{\hat{y} = b_0 + b_1 x }
\end{align*}\]</span></p>
<p>For a given data point, <span class="math inline">\((x_i, y_i)\)</span>, the observed value of <span class="math inline">\(y\)</span> is denoted as <span class="math inline">\(y_i\)</span> and the predicted value of <span class="math inline">\(y\)</span> is obtained by substituting <span class="math inline">\(x_i\)</span> into the prediction equation: <span class="math display">\[\begin{align*}
{\hat{y}_i = b_0 + b_1 x_i }
\end{align*}\]</span></p>
<p>The deviation of the <span class="math inline">\(i\)</span>th value of <span class="math inline">\(y\)</span> from its predicted value, called the <span class="math inline">\(i\)</span>th <em>residual</em>, is <span class="math display">\[
\begin{align*}
{e_i= \left(y_i-\hat{y}_i\right) }
\end{align*}
\]</span> Thus, SSE is just the sum of the squared residuals: <span class="math display">\[
SSE = \sum_{i=1}^n \left(y_i-\hat{y}_i\right)^2
\]</span></p>
<p>In practice we seldom calculate these estimates by hand; software computes them for us.</p>
</section>
<section id="example-advertising-and-sales-business" class="level3">
<h3 class="anchored" data-anchor-id="example-advertising-and-sales-business">Example: Advertising and sales (business)</h3>
<p>Consider the business example introduced earlier. The advertising budget (in thousands of dollars) serves as <span class="math inline">\(x\)</span>, and weekly sales (in thousands of dollars) serve as <span class="math inline">\(y\)</span>. A scatterplot suggests a strong positive association. Fitting a regression line by least squares yields an equation of the form</p>
<p><span class="math display">\[
\widehat{y} = 12.47 + 1.74 x,
\]</span></p>
<p>meaning that each additional thousand dollars spent on advertising is associated with an estimated increase of about 1.74 thousand dollars in weekly sales. The intercept (12.47) is the predicted sales when advertising spend is zero. Depending on context, the intercept may or may not have a meaningful interpretation; often it represents an extrapolation outside the observed data range.</p>
<p>Below is the scatterplot with the fitted regression line.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The slope 1.74 tells us that for each thousand‑dollar increase in advertising, sales increase by about 1.71 thousand dollars. The intercept 12.47 suggests that if a store spent nothing on advertising, the model predicts $12,470 in weekly sales. In reality, such an extrapolation may not be reasonable; always interpret the intercept within the range of your data.</p>
</section>
<section id="performing-regression-in-jmp-18" class="level3">
<h3 class="anchored" data-anchor-id="performing-regression-in-jmp-18">Performing regression in JMP 18</h3>
<p>To fit a simple linear regression in JMP:</p>
<ol type="1">
<li><strong>Load your data.</strong> Import or enter the variables into a JMP table.</li>
<li><strong>Fit the line.</strong> Choose <strong>Analyze → Fit Y by X</strong>. Assign the response variable to <strong>Y, Response</strong> and the explanatory variable to <strong>X, Factor</strong>, then click <strong>OK</strong>. A scatterplot appears with red triangles above it. Click the red triangle ► and select <strong>Fit Line</strong>. JMP displays the regression line, the estimated coefficients (<span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>), and the analysis of variance table.</li>
</ol>
</section>
<section id="recap-1" class="level3">
<h3 class="anchored" data-anchor-id="recap-1">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword/Concept</strong></th>
<th><strong>Explanation</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>simple linear regression</strong></td>
<td>A model relating a quantitative response <span class="math inline">\(y\)</span> to a single quantitative predictor <span class="math inline">\(x\)</span> via a straight line.</td>
</tr>
<tr class="even">
<td><strong>least squares</strong></td>
<td>A method that determines the intercept and slope by minimizing the sum of squared residuals.</td>
</tr>
<tr class="odd">
<td><strong>slope (<span class="math inline">\(b_1\)</span>)</strong></td>
<td>The change in the predicted response for a one‑unit increase in the explanatory variable; its sign indicates the direction of the relationship. The population slope is denoted <span class="math inline">\(\beta_1\)</span></td>
</tr>
<tr class="even">
<td><strong>intercept (<span class="math inline">\(b_0\)</span>)</strong></td>
<td>The predicted response when the explanatory variable equals zero; may or may not have a meaningful interpretation depending on context. The population intercept is denoted <span class="math inline">\(\beta_1\)</span>.</td>
</tr>
<tr class="odd">
<td><strong>residual</strong></td>
<td>The difference between an observed <span class="math inline">\(y\)</span> value and its predicted value <span class="math inline">\(e_i = y_i - \widehat{y}_i\)</span>.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding-1" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-1">Check your understanding</h3>
<ol type="1">
<li>Suppose you fit a regression model <span class="math inline">\(\widehat{y}=2.5 + 0.8x\)</span> relating hours of study (x) to exam score (y). Interpret the slope and the intercept.</li>
<li>Explain why the least squares method squares the residuals instead of simply summing them.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>The slope 0.8 means that for each additional hour of study, the predicted exam score increases by 0.8 points. The intercept 2.5 is the predicted exam score for a student who studies zero hours; it may not be meaningful if the data do not include students who studied so little.</li>
<li>Residuals can be positive or negative. If we simply added them, positive and negative errors would cancel out, giving a misleading impression of model fit. Squaring the residuals makes them all positive and penalizes larger discrepancies more heavily, ensuring that the line minimizes overall error.</li>
</ol>
</div>
</div>
</div>
<!-- ## Interpreting the Slope and Intercept {#sec-14_03} -->
<!-- > *Guiding question:* *What do the coefficients of a regression line tell us in context?* -->
<!-- While the previous section introduced the regression line, here we dig deeper into interpreting its coefficients.  The **slope** $b_1$ tells us how the predicted response changes when the predictor increases by one unit【667853646116998†L14-L21】.  If $b_1$ is positive, the regression line rises from left to right; if negative, it falls.  The magnitude of $b_1$ indicates how steep the line is.  A small slope (close to zero) implies that large changes in $x$ lead to small changes in the predicted $y$; a large slope indicates a stronger effect. -->
<!-- The **intercept** $b_0$ is the predicted value of $y$ when $x=0$.  In some situations it has a natural interpretation.  For instance, in the business example above, $b_0\approx 20.0$ means that a store with zero advertising dollars is predicted to sell about $20,000 per week (perhaps due to walk‑in customers).  In other contexts the intercept may be outside the range of observed $x$ values.  The height–weight example from earlier features an intercept of −150.9 pounds【667853646116998†L62-L67】, which is clearly not meaningful because nobody has a height of zero inches.  In such cases the slope is often the focus and the intercept is treated as a mathematical artifact. -->
<!-- ### Examples across fields -->
<!-- - **Medicine:** In pharmacokinetics, the relationship between drug dose ($x$) and concentration in blood ($y$) is often modeled linearly over a therapeutic range.  A slope of 0.2 means that each additional milligram of drug increases the concentration by 0.2 units.  The intercept might represent baseline concentration (e.g., residual drug from a previous dose). -->
<!-- - **Biology:** When studying growth, you might relate nutrient concentration to plant height.  A slope of 1.5 cm per nutrient unit indicates that increasing fertilizer by one unit yields plants 1.5 cm taller on average.  If the intercept is negative, it signals that the linear model is extrapolated below the smallest nutrient level and should not be taken literally. -->
<!-- - **Business:** In cost analysis, the total cost $y$ can often be written as a fixed cost ($b_0$) plus a variable cost per unit ($b_1$).  If a company has a fixed cost of $10,000 and spends $5 per unit produced, the regression equation would be $\widehat{\text{cost}} = 10{,}000 + 5x$.  Here both slope and intercept have clear interpretations. -->
<!-- ### Recap -->
<!-- | **Coefficient** | **Interpretation** | -->
<!-- |---|---| -->
<!-- | **Slope ($b_1$)** | Change in the predicted response for a one‑unit increase in the predictor; its sign indicates direction and its magnitude indicates steepness【667853646116998†L14-L21】. | -->
<!-- | **Intercept ($b_0$)** | Predicted response when the predictor is zero; meaningful only if zero is within or near the observed range【667853646116998†L62-L67】. | -->
<!-- ### Check your understanding -->
<!-- 1. A researcher models the relationship between body mass index (BMI) and blood cholesterol as $\widehat{\text{cholesterol}} = 110 + 2.5 \times \text{BMI}$.  Interpret the slope and intercept.  Why might the intercept be less meaningful than the slope? -->
<!-- 2. If the slope of a regression line is 0, what does this tell you about the relationship between the variables?  What would the scatterplot look like? -->
<!-- 3. Explain why the slope often has a more interpretable meaning than the intercept in regression models. -->
<!-- ::: {.callout-tip collapse="true" title="Solutions"} -->
<!-- 1. The slope 2.5 means that for each one‑unit increase in BMI, the predicted cholesterol level increases by 2.5 units.  The intercept 110 represents the predicted cholesterol level for a person with a BMI of 0.  Because BMI values near zero are unrealistic for humans, the intercept has little practical meaning; the slope better captures the relationship. -->
<!-- 2. A slope of 0 implies that predicted $y$ does not change with $x$; the regression line is horizontal.  The scatterplot would show no linear trend, and the correlation would be zero or near zero. -->
<!-- 3. The slope describes how changes in the predictor affect the response and is directly tied to the research question.  The intercept often corresponds to an extrapolation outside the data range and may not correspond to a real scenario, so its interpretation is less meaningful. -->
<!-- ::: -->
<!-- ## Assessing the Fit (R²) {#sec-14_04} -->
<!-- > *Guiding question:* *How much of the variability in the response is explained by our regression model?* -->
<!-- Once we have fit a regression line, we need a summary statistic that tells us how well the model captures the observed variation.  The **coefficient of determination**, denoted $R^2$, fulfills this role.  For simple linear regression, $R^2$ is simply the square of the correlation coefficient【564409152601504†L144-L145】.  It represents the proportion of the variability in $y$ that can be attributed to its linear relationship with $x$【564409152601504†L144-L146】.  By definition $0\le R^2\le 1$.  An $R^2$ close to 1 means the regression line explains most of the variability in the response; an $R^2$ near 0 means that the line explains little. -->
<!-- ### Interpreting R² -->
<!-- Suppose $r=0.93$ in our blood‑pressure example.  Then $R^2 = 0.93^2 \approx 0.86$.  This means that about 86% of the variability in systolic blood pressure is explained by age through a linear relationship.  The remaining 14% represents variability due to other factors and random noise.  In the advertising example with $r=0.98$, $R^2\approx 0.96$, suggesting that advertising spending explains 96% of the variation in sales.  High values of $R^2$ do not prove causation, and an excessively large $R^2$ can sometimes signal overfitting or the influence of an outlier.  Always inspect the scatterplot and residuals. -->
<!-- ### Getting R² in JMP -->
<!-- After fitting a regression line in JMP (via **Fit Y by X** and **Fit Line**), the **Summary of Fit** table shows several statistics.  The row labeled **R Square** gives $R^2$.  The **Root Mean Square Error** (RMSE) is the square root of the mean squared residuals and provides a measure of typical prediction error in the units of the response. -->
<!-- ### Recap -->
<!-- | **Statistic** | **Meaning** | -->
<!-- |---|---| -->
<!-- | **Coefficient of determination ($R^2$)** | The fraction of the variation in the response that can be explained by its linear relationship with the predictor【564409152601504†L144-L146】.  For simple linear regression, $R^2 = r^2$. | -->
<!-- | **Root mean square error (RMSE)** | The square root of the average squared residuals; provides a typical size of prediction error in the response variable’s units. | -->
<!-- ### Check your understanding -->
<!-- 1. If $r=0.50$ for a pair of variables, what is $R^2$?  Interpret this value in context. -->
<!-- 2. In the enzyme concentration example, the correlation was roughly 0.94.  What proportion of the variability in reaction rate does the linear model explain?  What percentage remains unexplained? -->
<!-- 3. Can an $R^2$ value ever be negative?  Explain why or why not. -->
<!-- ::: {.callout-tip collapse="true" title="Solutions"} -->
<!-- 1. Since $R^2 = r^2$, with $r=0.50$ we get $R^2 = 0.25$.  This means that about 25% of the variation in the response is explained by its linear relationship with the predictor.  The remaining 75% is due to other factors or random variation. -->
<!-- 2. $R^2 = 0.94^2 \approx 0.88$, so about 88% of the variability in reaction rate is explained by enzyme concentration.  Roughly 12% remains unexplained by this simple linear model. -->
<!-- 3. No.  $R^2$ is defined as the square of the correlation coefficient (or equivalently, as 1 minus the ratio of the residual sum of squares to the total sum of squares) and therefore must lie between 0 and 1.  A negative value would have no interpretation in this context. -->
<!-- ::: -->
<!-- ## Residual Analysis {#sec-14_05} -->
<!-- > *Guiding question:* *How do we check whether our regression model is appropriate?* -->
<!-- A regression line is a simplification of reality.  **Residuals**—the differences between observed and predicted values—tell us how well the model fits each observation【667853646116998†L120-L143】.  By plotting and analyzing residuals we can assess the validity of our linear model and its underlying assumptions. -->
<!-- ### Residual plots -->
<!-- The four main assumptions of simple linear regression are: -->
<!-- 1. **Linearity:** The relationship between $x$ and $y$ is linear【667853646116998†L215-L219】.  We assess this by examining the scatterplot and the residuals; a residual plot (residuals vs. fitted values) should show no systematic pattern. -->
<!-- 2. **Independence of errors:** Residuals are independent of each other【667853646116998†L219-L221】.  This is mainly a study‑design issue, but a residual plot with no obvious patterns supports independence. -->
<!-- 3. **Normality of errors:** Residuals are approximately normally distributed【667853646116998†L221-L225】.  Check this assumption with a normal probability plot or a histogram of the residuals. -->
<!-- 4. **Equal variances (homoscedasticity):** The spread of residuals is roughly constant across all fitted values【667853646116998†L228-L232】.  On a residual plot, the vertical spread should be similar across the range of $x$; funnels or megaphone shapes indicate heteroscedasticity. -->
<!-- Violations of these assumptions can invalidate inference.  For example, a curved pattern in the residual plot suggests that the relationship is nonlinear, calling for a transformation or a different model.  Non‑constant variance may require weighted regression or a transformation of the response. -->
<!-- ### Example: Checking assumptions -->
<!-- Consider the enzyme concentration data again.  After fitting the regression line, we compute the residuals and plot them against the fitted values. -->
<!-- ```{r} -->
<!-- # continuing from the biology example -->
<!-- enzyme <- tibble( -->
<!--   conc = seq(1, 10, length.out = 15), -->
<!--   rate = 2 + 0.5 * conc + rnorm(15, 0, 0.5) -->
<!-- ) -->
<!-- model_bio <- lm(rate ~ conc, data = enzyme) -->
<!-- enzyme$residuals <- residuals(model_bio) -->
<!-- enzyme$fit       <- fitted(model_bio) -->
<!-- ggplot(enzyme, aes(x = fit, y = residuals)) + -->
<!--   geom_point(color = "#af8dc3") + -->
<!--   geom_hline(yintercept = 0, linetype = "dashed") + -->
<!--   labs(x = "Fitted values", y = "Residuals", -->
<!--        title = "Residuals vs fitted values (biology example)") + -->
<!--   theme_minimal() -->
<!-- ``` -->
<!-- If the linear model is appropriate, the residuals should be randomly scattered around zero with constant variance.  You can also create a normal probability plot of the residuals.  In R, use `qqnorm(enzyme$residuals)` and `qqline(enzyme$residuals)`; in JMP, select **Save Residuals** in the regression output and then use **Graph → Distribution** or **Analyze → Fit Y by X** to examine the residuals. -->
<!-- ### Conducting residual analysis in JMP -->
<!-- 1. **Save residuals.**  In the **Fit Y by X** output window, click the red triangle ► and choose **Save Residuals**.  A new column of residuals appears in your data table. -->
<!-- 2. **Plot residuals vs. fitted values.**  Choose **Graph → Graph Builder**, drag the fitted values (predicted $y$) to the X‑axis and residuals to the Y‑axis, and select the *Scatter Plot* element.  The plot should show no obvious pattern if the linearity and equal‑variance assumptions are satisfied. -->
<!-- 3. **Check normality.**  Use **Analyze → Distribution** on the residuals column.  Inspect the histogram and normal quantile plot.  If the residuals deviate greatly from normality, consider transformations or nonparametric methods. -->
<!-- ### Recap -->
<!-- | **Concept** | **Description** | -->
<!-- |---|---| -->
<!-- | **Residual (error)** | The difference between an observed response and the value predicted by the regression line【667853646116998†L120-L143】. | -->
<!-- | **Residual plot** | Scatterplot of residuals vs. fitted values; used to check linearity and constant variance assumptions【667853646116998†L215-L232】. | -->
<!-- | **Normal probability plot** | Plot comparing the distribution of residuals to a theoretical normal distribution; helps assess the normality assumption【667853646116998†L221-L225】. | -->
<!-- | **Equal variance (homoscedasticity)** | Assumption that residuals have constant variance across levels of the predictor; checked by looking for uniform spread in residual plots【667853646116998†L228-L232】. | -->
<!-- ### Check your understanding -->
<!-- 1. Describe what you would look for in a residual vs. fitted plot to decide whether the linearity assumption is satisfied. -->
<!-- 2. Why is it important that residuals have constant variance?  What problems arise if this assumption is violated? -->
<!-- 3. Explain how you would check the normality of residuals in JMP. -->
<!-- ::: {.callout-tip collapse="true" title="Solutions"} -->
<!-- 1. A residual vs. fitted plot should show residuals randomly scattered around zero with no systematic pattern.  If you see a curve, clusters or a funnel shape, the linearity assumption may be violated【667853646116998†L215-L232】. -->
<!-- 2. Constant variance ensures that the model’s prediction errors are equally reliable across all values of the predictor.  If the variance increases or decreases with the fitted values (heteroscedasticity), the standard errors of the coefficients may be biased, leading to misleading inference.  In such cases you might transform the response or use weighted least squares. -->
<!-- 3. After saving residuals in JMP, use **Analyze → Distribution** to generate a histogram and normal quantile plot.  If the histogram is roughly bell‑shaped and the points in the quantile plot lie close to the reference line, the normality assumption is reasonable.  Significant departures (skewness or heavy tails) suggest that a transformation or a different model may be needed. -->
<!-- ::: -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>