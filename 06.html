<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Discrete Probability Distributions – STA 2381 Introductory Statistical Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2ea2d3e7f2364fcda3d434693d3458e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style type="text/css">
.sidebar .chapter-number {
color: #FFB81c;
}
freeblank {
  color: transparent;
  cursor: pointer;
}
freeblank.clicked {
  color: red;
}
blank {
  display: inline-block; 
  position: relative;
  padding: 0 10px;
  color: transparent;
  cursor: pointer;
}
blank::before {
  content: ''; /* Creates a custom underline */
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 1px; /* Thickness of the underline */
  background-color: black; /* Color of the underline */
}
blank.clicked {
  color: red;
}
</style>
<script>
document.addEventListener('click', (event) => {
  if (event.target.tagName === 'BLANK') {
    event.target.classList.add('clicked');
  }
});
document.addEventListener('click', (event) => {
  if (event.target.tagName === 'FREEBLANK') {
    event.target.classList.add('clicked');
  }
});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Collecting Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Describing Data with Tables and Graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Describing Data with Numbers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sampling Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation and Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesis Testing: The Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis Testing with Categorical Response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Methods for Quantitative Response Variables – One and Two Groups</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-06_01" id="toc-sec-06_01" class="nav-link active" data-scroll-target="#sec-06_01"><span class="header-section-number">6.1</span> Random Variables</a>
  <ul class="collapse">
  <li><a href="#working-in-jmp-pro-17" id="toc-working-in-jmp-pro-17" class="nav-link" data-scroll-target="#working-in-jmp-pro-17">Working in JMP Pro 17</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#check-your-understanding" id="toc-check-your-understanding" class="nav-link" data-scroll-target="#check-your-understanding">Check your understanding</a></li>
  </ul></li>
  <li><a href="#sec-06_02" id="toc-sec-06_02" class="nav-link" data-scroll-target="#sec-06_02"><span class="header-section-number">6.2</span> Probability Distributions and Their Properties</a>
  <ul class="collapse">
  <li><a href="#validity-checks" id="toc-validity-checks" class="nav-link" data-scroll-target="#validity-checks">Validity checks</a></li>
  <li><a href="#working-in-jmp-pro-17-1" id="toc-working-in-jmp-pro-17-1" class="nav-link" data-scroll-target="#working-in-jmp-pro-17-1">Working in JMP Pro 17</a></li>
  <li><a href="#recap-1" id="toc-recap-1" class="nav-link" data-scroll-target="#recap-1">Recap</a></li>
  <li><a href="#check-your-understanding-1" id="toc-check-your-understanding-1" class="nav-link" data-scroll-target="#check-your-understanding-1">Check your understanding</a></li>
  </ul></li>
  <li><a href="#sec-06_03" id="toc-sec-06_03" class="nav-link" data-scroll-target="#sec-06_03"><span class="header-section-number">6.3</span> Mean and Standard Deviation of Discrete Distributions</a>
  <ul class="collapse">
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance">Variance</a></li>
  <li><a href="#working-in-jmp-pro-17-2" id="toc-working-in-jmp-pro-17-2" class="nav-link" data-scroll-target="#working-in-jmp-pro-17-2">Working in JMP Pro 17</a></li>
  <li><a href="#recap-2" id="toc-recap-2" class="nav-link" data-scroll-target="#recap-2">Recap</a></li>
  <li><a href="#check-your-understanding-2" id="toc-check-your-understanding-2" class="nav-link" data-scroll-target="#check-your-understanding-2">Check your understanding</a></li>
  </ul></li>
  <li><a href="#sec-06_04" id="toc-sec-06_04" class="nav-link" data-scroll-target="#sec-06_04"><span class="header-section-number">6.4</span> The Binomial Distribution</a>
  <ul class="collapse">
  <li><a href="#mean-and-standard-deviation-of-the-binomial-distribution" id="toc-mean-and-standard-deviation-of-the-binomial-distribution" class="nav-link" data-scroll-target="#mean-and-standard-deviation-of-the-binomial-distribution">Mean and Standard Deviation of the Binomial Distribution</a></li>
  <li><a href="#working-in-jmp-pro-17-3" id="toc-working-in-jmp-pro-17-3" class="nav-link" data-scroll-target="#working-in-jmp-pro-17-3">Working in JMP Pro 17</a></li>
  <li><a href="#recap-3" id="toc-recap-3" class="nav-link" data-scroll-target="#recap-3">Recap</a></li>
  <li><a href="#check-your-understanding-3" id="toc-check-your-understanding-3" class="nav-link" data-scroll-target="#check-your-understanding-3">Check your understanding</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-06_01" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-06_01"><span class="header-section-number">6.1</span> Random Variables</h2>
<blockquote class="blockquote">
<p>“There are some statistics that I’d like to share with you now, and they are numbers.” - Perd Hapley (<em>Parks and Recreation</em>)</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>What is a random variable, and how does it relate to data?</em></p>
</blockquote>
<p>With proper methods of gathering data, the values that a variable assumes should be the result of some random phenomenon.</p>
<p>These outcomes may not be numeric. In fact, are any outcomes of an random phenomenon really numbers?</p>
<p>In reality, numbers are just <blank>abstractions</blank> that we assign to measurement.</p>
<p>For instance, what is weight?<br>
It is a <blank>force</blank> put on an object due to the mass of the object and gravity.</p>
<p>So weight is not really a number, however, we assign numerical values as a representation of weight.</p>
<p>How about rolling a six-sided die?<br>
The sample space contains</p>
<div style="text-align: center;">
<p><img src="images/sidesofdie.jpg" class="img-fluid" style="width:4in"></p>
</div>
<p>We have a rule for which we assign <span class="math display">\[
\left\{1, 2, 3, 4, 5, 6\right\}
\]</span></p>
<p>to the possible outcomes of rolling the die.</p>
<p>Thus we have a function whose domain is the <blank>sample space</blank> and whose range is the set of <blank>real numbers</blank>.</p>
<p>This function is called a <blank>random variable</blank>.</p>
<p>Let’s think about it another way: When we talk about <em>chance</em>, we need a language for turning the messy, unpredictable outcomes of an experiment into numbers we can reason about. A <em>random variable</em> does exactly that: it assigns a numerical value to each outcome in the sample space of a random experiment. Think of it as a function that converts “what happened” into a number you can analyze.</p>
<p>Random variables come in two broad types:</p>
<ul>
<li>A <em>discrete</em> random variable has a countable set of possible values. Many of our examples in this course will involve counts, like the number of patients responding to a treatment or the number of mutations in a DNA sample.</li>
<li>A <em>continuous</em> random variable can take any value on an interval, such as a person’s height or blood pressure. We will encounter continuous variables in the next chapter; in this chapter our focus is on discrete random variables.</li>
</ul>
<p>A random variable is not the data itself—it describes the process that produces the data. For example:</p>
<p><em>Medicine.</em> Suppose a clinic screens 20 patients for a rare side effect of a new drug. Let <span class="math inline">\(X\)</span> denote the <em>number of patients</em> in the sample who experience the side effect. Before the experiment, <span class="math inline">\(X\)</span> could be 0, 1, 2, …, up to 20. Each of those values corresponds to a different pattern of outcomes in the sample. Once the screening is done, we observe a single value of <span class="math inline">\(X\)</span> (say 3), which is a realization of the random variable. Another clinic, under the same conditions, might see a different number of side effects because <span class="math inline">\(X\)</span> is random.</p>
<p><em>Biology.</em> In a genetics lab you grow 10 plants from seeds, each of which may carry a mutation that confers resistance to a fungus. Let <span class="math inline">\(Y\)</span> be the number of resistant plants. The possible values of <span class="math inline">\(Y\)</span> are 0 through 10. The distribution of <span class="math inline">\(Y\)</span> depends on the underlying mutation frequency, and we can use the tools of probability to model <span class="math inline">\(Y\)</span> without observing every possible outcome.</p>
<p>In both cases, the random variable turns a complicated outcome (many patients or plants, each with its own result) into a single count. That count varies from trial to trial, but its behavior is governed by the probabilities of the underlying experiment.</p>
<section id="working-in-jmp-pro-17" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17">Working in JMP Pro 17</h3>
<p>In JMP you can work with discrete random variables by creating a column that represents the outcome of a chance process. For example:</p>
<ol type="1">
<li><strong>Simulate a random count.</strong> To explore the distribution of a count like <span class="math inline">\(X\)</span> or <span class="math inline">\(Y\)</span>, use <strong>Rows → Add Rows</strong> to create a data table with a desired number of simulated trials (say 1000). Add a new column, choose <strong>Column → Formula</strong>, and use a random function such as <code>Random Binomial(n, p)</code> to generate counts of successes (e.g., the number of side effects among 20 patients with probability <span class="math inline">\(p\)</span> of a side effect per patient). Each row in this column is one realization of your discrete random variable.</li>
<li><strong>Explore the distribution.</strong> Use <strong>Analyze → Distribution</strong> to see how often each value occurs. The histogram and summary tables show the possible values and their relative frequencies. This empirical distribution will get closer to the true probability distribution as you increase the number of simulated trials.</li>
</ol>
</section>
<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>random variable</strong></td>
<td>A function that assigns a numeric value to each outcome of a random experiment.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding">Check your understanding</h3>
<ol type="1">
<li>Describe in your own words the difference between a random variable and the observed data.<br>
</li>
<li>Give an example of a discrete random variable in a medical context and list its possible values.<br>
</li>
<li>Is “blood type” (A, B, AB, O) a discrete random variable? Explain why or why not.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>The <strong>random variable</strong> is a rule that maps every possible outcome of a random experiment to a number. The <em>observed data</em> are the actual values of that mapping in one experiment. Before you flip 10 coins, the random variable “number of heads” could be 0–10; after you flip, you observe a single number, such as 4.</li>
<li>Let <span class="math inline">\(X\)</span> be the number of patients out of 15 who respond favorably to a new therapy. The possible values of <span class="math inline">\(X\)</span> are 0,1,2,…,15—one number for each possible count of responders.</li>
<li>Blood type is <strong>categorical</strong> rather than numeric. To analyze it as a random variable you would typically convert it to a binary indicator (e.g., 1 if type A, 0 otherwise). The categories A, B, AB and O do not have a numerical order, so blood type on its own is not a discrete random variable in the sense used here.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-06_02" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sec-06_02"><span class="header-section-number">6.2</span> Probability Distributions and Their Properties</h2>
<blockquote class="blockquote">
<p>“Iacta alea est. (The die is cast.)” - Julius Ceasar</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>What is a probability distribution, and what makes it valid?</em></p>
</blockquote>
<p>Once we have defined a discrete random variable, the next step is to describe how likely each of its possible values is. A <blank>probability distribution</blank> (also called a <strong>probability mass function</strong>) assigns a probability <span class="math inline">\(P(X=x)\)</span> to every value <span class="math inline">\(x\)</span> in the support of the random variable <span class="math inline">\(X\)</span>. A valid probability distribution must satisfy two simple but fundamental conditions:</p>
<ol type="1">
<li><em>Non‑negativity:</em> For every possible value <span class="math inline">\(x\)</span>, the probability satisfies <span class="math inline">\(0 \le P(X=x) \le 1\)</span>. Probabilities can’t be negative or exceed one.</li>
<li><em>Sum to one:</em> The probabilities of all possible outcomes add up to one: <span class="math display">\[
\sum_{x} P(X=x) = 1\,.
\]</span> This reflects the fact that something in the sample space must occur on each trial.</li>
</ol>
<p>A probability distribution summarizes the long‑run behavior of a random variable. It tells you how often each value would appear if you repeated the experiment many times. Let’s look at an example.</p>
<section id="example-number-of-mutated-alleles" class="level4">
<h4 class="anchored" data-anchor-id="example-number-of-mutated-alleles">Example: number of mutated alleles</h4>
<p>Suppose biologists examine individual plants and record the number of copies of a recessive allele they carry. The random variable <span class="math inline">\(X\)</span> takes the values 0, 1, 2 or 3 with the following probabilities:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P(X=x)\)</span></td>
<td>0.50</td>
<td>0.30</td>
<td>0.15</td>
<td>0.05</td>
</tr>
</tbody>
</table>
<p>Every probability is between 0 and 1, and the probabilities sum to <span class="math display">\[
0.50+0.30+0.15+0.05=1
\]</span> Thus this table is a valid probability distribution. If you grew a very large number of plants from the same genetic cross, about 50% would carry no copies of the allele, 30% would have one copy, 15% two copies, and 5% three copies.</p>
<p>Commonly, the probability distribution of a discrete random variable is displayed with a bar chart. As long as the bar chart displays all possible values of the random variable, and the probability of each value, then it displays the probability distribution.</p>
<p>Below is a bar chart for the probability distribution in the table above.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p><strong>Example: Medical testing</strong> In medical testing you often have a random variable that counts the number of positive results in a sample. For instance, if you screen 5 animals for a virus and each has a small probability of being infected, the distribution of <span class="math inline">\(Y\)</span> = “number of infected animals” might look something like this:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(y\)</span></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P(Y=y)\)</span></td>
<td>0.70</td>
<td>0.21</td>
<td>0.07</td>
<td>0.015</td>
<td>0.004</td>
<td>0.001</td>
</tr>
</tbody>
</table>
<p>Again, each probability is between 0 and 1 and the sum is 1. The table is more detailed because there are more possible counts, but the principles are the same.</p>
</section>
<section id="validity-checks" class="level3">
<h3 class="anchored" data-anchor-id="validity-checks">Validity checks</h3>
<p>Sometimes you will be given a proposed distribution and asked whether it is valid. To check validity:</p>
<ol type="1">
<li>Make sure all probabilities are non‑negative and at most 1.</li>
<li>Add them up. If they sum to 1 (allowing for small rounding error) the distribution is valid; otherwise it is not.</li>
</ol>
<p>If a distribution is not valid, you cannot use it until it is corrected or rescaled.</p>
</section>
<section id="working-in-jmp-pro-17-1" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17-1">Working in JMP Pro 17</h3>
<p>To examine a discrete probability distribution in JMP:</p>
<ol type="1">
<li><strong>Enter the values and probabilities.</strong> Create a new data table with one column for the possible values and another for the corresponding probabilities. Be careful that your probabilities add to 1.</li>
<li><strong>Visualise the distribution.</strong> Use <strong>Graph → Graph Builder</strong>. Drag the value column to the X‑axis and the probability column to the Y‑axis. Choose <em>Bar</em> as the graph type. The resulting bar chart is your probability mass function. You can also label the bars with the probabilities by clicking the red triangle ▸ and selecting <strong>Label</strong>.</li>
<li><strong>Check the sum.</strong> You can add a column formula using <strong>Column → New Column</strong> and formula <code>sum(:Probability)</code> to verify that the probabilities sum to one. JMP will report the sum in a single cell.</li>
</ol>
</section>
<section id="recap-1" class="level3">
<h3 class="anchored" data-anchor-id="recap-1">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>probability distribution</strong></td>
<td>A table, graph, or function assigning each possible value of a discrete random variable a probability between 0 and 1.</td>
</tr>
<tr class="even">
<td><strong>probability mass function (pmf)</strong></td>
<td>Another name for the probability distribution of a discrete random variable.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding-1" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-1">Check your understanding</h3>
<ol type="1">
<li><p>Consider a random variable <span class="math inline">\(X\)</span> that takes values 0, 1, 2 with <span class="math inline">\(P(X=0)=0.2\)</span>, <span class="math inline">\(P(X=1)=0.5\)</span> and <span class="math inline">\(P(X=2)=0.4\)</span>. Is this a valid probability distribution? Explain.<br>
</p></li>
<li><p>A diagnostic test counts the number of positive samples among three blood samples from the same patient. Suggest a possible probability distribution for the number of positives and describe how you might visualize it.<br>
</p></li>
<li><p>The following table describes a proposed distribution for a random variable <span class="math inline">\(X\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P(X=x)\)</span></td>
<td>0.3</td>
<td><span class="math inline">\(–0.1\)</span></td>
<td>0.6</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>Is this distribution valid? Why or why not?</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>The probabilities must sum to 1. Here <span class="math inline">\(0.2 + 0.5 + 0.4 = 1.1\)</span>, which is greater than 1, so this is <strong>not</strong> a valid distribution. One or more probabilities needs to be adjusted or rescaled.</li>
<li>The number of positive samples (<span class="math inline">\(Y\)</span>) can be 0, 1, 2 or 3. A plausible distribution might be <span class="math inline">\(P(Y=0)=0.70\)</span>, <span class="math inline">\(P(Y=1)=0.20\)</span>, <span class="math inline">\(P(Y=2)=0.08\)</span> and <span class="math inline">\(P(Y=3)=0.02\)</span>, but the actual numbers depend on the underlying infection probability. To visualize the distribution, enter these values and probabilities into JMP and create a bar chart with categories 0–3 on the X‑axis and probabilities on the Y‑axis.</li>
<li>A valid distribution cannot have negative probabilities. Because <span class="math inline">\(P(Z=1)=-0.1\)</span> is negative, this table is invalid. You cannot assign negative weight to an outcome. The probabilities also sum to <span class="math inline">\(0.3-0.1+0.6+0.2=1.0\)</span>, but the negativity alone makes it invalid.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-06_03" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-06_03"><span class="header-section-number">6.3</span> Mean and Standard Deviation of Discrete Distributions</h2>
<blockquote class="blockquote">
<p>“The most important questions of life are, for the most part, really only problems of probability.” -Pierre Simon, Marquis de Laplace</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>How do we find the mean and standard deviation of a discrete random variable?</em></p>
</blockquote>
<p>As stated previously in this course, we want to examine the <blank>center</blank>, <blank>spread</blank>, and <blank>shape</blank> when we have a data distribution. In Chapter 4, we discussed doing this with sample data where we calculate statistics like <span class="math inline">\(\bar{x}\)</span>, <span class="math inline">\(s\)</span>, and <span class="math inline">\(s^2\)</span>. These are <strong>sample</strong> statistics. The probability distribution tells us how likely <strong>each</strong> outcome of <span class="math inline">\(X\)</span> is. Thus, we should view the probability distribution as a representation of the <blank>population</blank>.</p>
<p>We often want numeric values to describe the probability distribution in the same way we used statistics for the sample. Since these numeric values will be describing a population, these will be <blank>parameters</blank>.</p>
<p>It is common (but not always) to denote parameters with lowercase Greek letters. Below are some of the statistics we have discussed and the corresponding parameter.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Sample<br>Statistic</th>
<th>Population<br>Parameter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td><span class="math inline">\(\bar{x}\)</span></td>
<td><span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="even">
<td>Standard Deviation</td>
<td><span class="math inline">\(s\)</span></td>
<td><span class="math inline">\(\sigma\)</span></td>
</tr>
<tr class="odd">
<td>Variance</td>
<td><span class="math inline">\(s^2\)</span></td>
<td><span class="math inline">\(\sigma^2\)</span></td>
</tr>
</tbody>
</table>
<p>The mean or <blank>expected value</blank> (denoted <span class="math inline">\(E(X)\)</span>) of a discrete probability distribution is a weighted average: <span class="math display">\[
\mu = E(X) = \sum_x x \cdot P(X=x)
\]</span> You can think of the expected value as the long‑run average of <span class="math inline">\(X\)</span> over many repetitions of the experiment.</p>
<section id="example-florida-lottery" class="level4">
<h4 class="anchored" data-anchor-id="example-florida-lottery">Example: Florida lottery</h4>
<p>The Florida Lottery runs two popular daily games called Pick 3 and Pick 4.</p>
<p>In Cash 3, players pay $1 to select three numbers in order, where each number ranges from 0 to 9. If the three numbers selected (e.g., 2–8–4) match exactly the order of the three numbers drawn, the player wins $500. The probability of winning Pick 3 is 0.001.</p>
<p>Play 4 is similar to Cash 3, but players must match four numbers (each number ranging from 0 to 9). For a $1 Play 4 ticket (e.g., 3–8–3–0), the player will win $5,000 if the numbers match the order of the four numbers drawn. The probability of winning Pick 4 is 0.0001</p>
<p>Let <span class="math inline">\(X\)</span> be the random variable representing the amount of money you get for playing Pick 3.</p>
<p>The possible values of <span class="math inline">\(X\)</span> is then<br>
If you lose: <span class="math inline">\(-\$1\)</span><br>
If you win: <span class="math inline">\(\$500-\$1=\$499\)</span></p>
<p>What is the expected amount of money you get for playing this game? <span class="math display">\[
\begin{align*}
    \mu &amp;= \sum xP(x)\\\\
    &amp;{=-1(0.999)+499(0.001)}\\
    &amp;{=-0.999+.499}\\
    &amp;{=-0.5}
\end{align*}
\]</span></p>
<p>Let <span class="math inline">\(X\)</span> be the random variable representing the amount of money you get for playing Pick 4.</p>
<p>The possible values of <span class="math inline">\(X\)</span> is then<br>
If you lose: <span class="math inline">\(-\$1\)</span><br>
If you win: <span class="math inline">\(\$5000-\$1=\$4999\)</span> The possible values of <span class="math inline">\(X\)</span> is then</p>
<p>What is the expected amount of money you get for playing this game? <span class="math display">\[
\begin{align*}
    \mu &amp;= \sum xP(x)\\\\
    &amp;{=-1(0.9999)+4999(0.0001)}\\
    &amp;{=-0.9999+.4999}\\
    &amp;{=-0.5}
\end{align*}
\]</span></p>
</section>
<section id="example-life-insurance" class="level4">
<h4 class="anchored" data-anchor-id="example-life-insurance">Example: Life insurance</h4>
<p>Suppose you work for an insurance company and you sell a $10,000 one-year term insurance policy at an annual premium of $290. Actuarial tables show that the probability of death during the next year for a person of your customer’s age, sex, health, etc., is .001. What is the expected gain (amount of money made by the company) for a policy of this type? <span class="math display">\[X=\text{money made by the company  per policy}\]</span> If the customer lives: <span class="math inline">\(\$290\)</span><br>
If the customer dies:<span class="math inline">\(\$290-\$10,000=-\$9710\)</span></p>
<p>The expected gain for a policy of this type: <span class="math display">\[
\begin{align*}
    \mu &amp;= \sum xP(x)\\\\
    &amp;{=290(0.999)+(-9710)(0.001)}\\
    &amp;{=280}
\end{align*}
\]</span></p>
</section>
<section id="variance" class="level3">
<h3 class="anchored" data-anchor-id="variance">Variance</h3>
<p>The <blank>variance</blank> of <span class="math inline">\(X\)</span>, denoted <span class="math inline">\(\sigma^2\)</span>, measures how spread out <span class="math inline">\(X\)</span> is around its mean. It is defined as <span class="math display">\[
\begin{align*}
\sigma^2 = \sum_x (x - \mu)^2  P(X=x)
\end{align*}
\]</span></p>
<p>It weights squared deviations from the mean by the probability of each value. The <blank>standard deviation</blank> <span class="math inline">\(\sigma\)</span> is simply the square root of the variance. It has the same units as <span class="math inline">\(X\)</span> and describes the typical distance between <span class="math inline">\(X\)</span> and its mean.</p>
<section id="example-allele-copies-revisited" class="level4">
<h4 class="anchored" data-anchor-id="example-allele-copies-revisited">Example: allele copies revisited</h4>
<p>Using the allele copy distribution from the previous section, we can compute the mean and variance. Recall the probabilities:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P(X=x)\)</span></td>
<td>0.50</td>
<td>0.30</td>
<td>0.15</td>
<td>0.05</td>
</tr>
</tbody>
</table>
<p>The expected value is</p>
<p><span class="math display">\[
\begin{align*}
\mu_X =&amp; 0 \cdot 0.50 + 1 \cdot 0.30 + 2 \cdot 0.15 + 3 \cdot 0.05\\
=&amp; 0 + 0.30 + 0.30 + 0.15 \\
=&amp; 0.75
\end{align*}
\]</span></p>
<p>On average, a plant carries 0.75 copies of the allele. To compute the variance, we first calculate <span class="math inline">\((x - \mu)^2\)</span> for each <span class="math inline">\(x\)</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th><span class="math inline">\((x - 0.75)^2\)</span></th>
<th><span class="math inline">\(P(X=x)\)</span></th>
<th>Contribution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td><span class="math inline">\((0 - 0.75)^2 = 0.5625\)</span></td>
<td>0.50</td>
<td><span class="math inline">\(0.5625 \times 0.50 = 0.28125\)</span></td>
</tr>
<tr class="even">
<td>1</td>
<td><span class="math inline">\((1 - 0.75)^2 = 0.0625\)</span></td>
<td>0.30</td>
<td><span class="math inline">\(0.0625 \times 0.30 = 0.01875\)</span></td>
</tr>
<tr class="odd">
<td>2</td>
<td><span class="math inline">\((2 - 0.75)^2 = 1.5625\)</span></td>
<td>0.15</td>
<td><span class="math inline">\(1.5625 \times 0.15 = 0.234375\)</span></td>
</tr>
<tr class="even">
<td>3</td>
<td><span class="math inline">\((3 - 0.75)^2 = 5.0625\)</span></td>
<td>0.05</td>
<td><span class="math inline">\(5.0625 \times 0.05 = 0.253125\)</span></td>
</tr>
</tbody>
</table>
<p>The variance is the sum of the contributions: <span class="math display">\[
\sigma^2 = 0.28125 + 0.01875 + 0.234375 + 0.253125 = 0.7875
\]</span></p>
<p>Thus the standard deviation is <span class="math display">\[
\sigma = \sqrt{0.7875} \approx 0.887
\]</span></p>
<p>This tells us that individual plants typically differ from the mean of 0.75 allele copies by about 0.89 copies. Remember that the mean and standard deviation summarize the distribution; they do not necessarily correspond to actual observed values (you cannot have 0.75 copies of a gene, but the average over many plants can be fractional).</p>
</section>
</section>
<section id="working-in-jmp-pro-17-2" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17-2">Working in JMP Pro 17</h3>
<p>To compute the mean and standard deviation of a discrete distribution in JMP:</p>
<ol type="1">
<li><strong>Enter the distribution.</strong> Create a table with columns for the values and their probabilities.</li>
<li><strong>Calculate the expected value.</strong> Add a new column and use <strong>Column → Formula</strong> to multiply each value by its probability. Then use <strong>Tables → Summary</strong> to sum that column. The sum is <span class="math inline">\(\mu_X\)</span>.</li>
<li><strong>Compute the variance and standard deviation.</strong> Add a column for <span class="math inline">\((x - \mu)^2 \times P(X=x)\)</span> (you can store <span class="math inline">\(\mu_X\)</span> in a script variable for reuse). Summarize that column to get the variance. Take the square root for the standard deviation. Alternatively, use <strong>Distribution</strong> on the simulated values (as described in Section 6.1) to see empirical estimates of the mean and standard deviation.</li>
</ol>
</section>
<section id="recap-2" class="level3">
<h3 class="anchored" data-anchor-id="recap-2">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>expected value</strong></td>
<td>Weighted average of a random variable: <span class="math inline">\(\sum_x x \,P(X=x)\)</span>. Another name for population mean.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding-2" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-2">Check your understanding</h3>
<ol type="1">
<li>A random variable <span class="math inline">\(W\)</span> takes values 0, 1, 2, 3 with <span class="math inline">\(P(W=0)=0.1\)</span>, <span class="math inline">\(P(W=1)=0.2\)</span>, <span class="math inline">\(P(W=2)=0.4\)</span> and <span class="math inline">\(P(W=3)=0.3\)</span>. Compute <span class="math inline">\(E(W)\)</span> and <span class="math inline">\(\sigma_W\)</span>.<br>
</li>
<li>Explain in plain language what the standard deviation tells you about a random variable.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Compute the mean: <span class="math inline">\(E(W) = 0(0.1) + 1(0.2) + 2(0.4) + 3(0.3) = 0 + 0.2 + 0.8 + 0.9 = 1.9\)</span>. The variance is <span class="math display">\[
\sum (w - 1.9)^2 P(W=w) = (0-1.9)^2\cdot 0.1 + (1-1.9)^2\cdot 0.2 + (2-1.9)^2\cdot 0.4 + (3-1.9)^2\cdot 0.3.
\]</span> Numerically this is <span class="math inline">\(3.61(0.1) + 0.81(0.2) + 0.01(0.4) + 1.21(0.3) = 0.361 + 0.162 + 0.004 + 0.363 = 0.890\)</span>. Thus <span class="math inline">\(\sigma = \sqrt{0.890} \approx 0.944\)</span>.</li>
<li>The standard deviation measures how far the values of a random variable typically fall from their average value. A small standard deviation means the values cluster tightly around the mean; a larger standard deviation means the values are more spread out and vary more from trial to trial.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-06_04" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="sec-06_04"><span class="header-section-number">6.4</span> The Binomial Distribution</h2>
<blockquote class="blockquote">
<p>“If people do not believe that mathematics is simple, it is only because they do not realize how complicated life is.” -John Louis von Neumann</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>How does the binomial model real-world “success/failure” data?</em></p>
</blockquote>
<p>Many count variables in medicine and biology arise from a simple process: you perform the same experiment <span class="math inline">\(n\)</span> times, each time there are only two possible outcomes (success or failure), and the probability of success stays the same from trial to trial. The random variable that counts the number of successes in these <span class="math inline">\(n\)</span> trials is said to follow a <blank>binomial distribution</blank>. We denote it by <span class="math inline">\(X \sim \mathrm{Bin}(n,p)\)</span>, where:</p>
<ul>
<li><span class="math inline">\(n\)</span> is the number of independent trials.</li>
<li><span class="math inline">\(p\)</span> is the probability of success on each trial.</li>
</ul>
<p>For the binomial model to be appropriate we must have:</p>
<ol type="1">
<li>A fixed number <span class="math inline">\(n\)</span> of trials.</li>
<li>Each trial results in a <em>success</em> or <em>failure</em>.</li>
<li>The probability <span class="math inline">\(p\)</span> of success is the same on every trial.</li>
<li>The trials are independent of each other.</li>
</ol>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example:</h4>
<p>John Doe claims to possess extrasensory perception (ESP). An experiment is conducted in which a person in one room picks one of the integers 1, 2, 3, 4, 5 at random and concentrates on it for one minute. In another room, John Doe identifies the number he believes was picked. The experiment is done with three trials. After the third trial, the random numbers are compared with John Doe’s predictions. Doe got the correct result twice.</p>
<p>If John Doe does not actually have ESP and is merely guessing the number, what is the probability that he’d make a correct guess on two of the three trials?</p>
<p>Let <span class="math inline">\(X\)</span> = number of correct guesses in <span class="math inline">\(n = 3\)</span> trials. Then <span class="math inline">\(X = 0, 1, 2, \text{ or } 3\)</span>.</p>
<p>Let <span class="math inline">\(p\)</span> denote the probability of a correct guess for a given trial.</p>
<p>If Doe is guessing, <span class="math inline">\(p = 0.2\)</span> for Doe’s prediction of one of the five possible integers. Then, <span class="math inline">\(1 - p = 0.8\)</span> is the probability of an incorrect prediction on a given trial.</p>
<p>Denote the outcome on a given trial by <span class="math inline">\(S\)</span> or <span class="math inline">\(F\)</span>, representing success or failure for whether Doe’s guess was correct or not. The table below shows the eight outcomes in the sample space for this experiment. For instance, <span class="math inline">\(FSS\)</span> represents a correct guess on the second and third trials. It also shows their probabilities by using the multiplication rule for independent events.</p>
<div style="text-align: center;">
<p><img src="images/06_07_esptable.png" class="img-fluid" style="width:4in"></p>
</div>
<p>The three ways John Doe could make two correct guesses in three trials are <span class="math inline">\(SSF\)</span>, <span class="math inline">\(SFS\)</span>, and <span class="math inline">\(FSS\)</span>. Each of these has probability equal to <span class="math display">\[
(0.2)^2(0.8) = 0.032
\]</span></p>
<p>The total probability of two correct guesses (note these are mutually exclusive outcomes) is <span class="math display">\[
\begin{align*}
P(SSF\cup SFS \cup FSS) = &amp; (0.2)^2(0.8) + (0.2)^2(0.8) + (0.2)^2(0.8)\\
=&amp; 3(0.2)^2(0.8)\\
=&amp; 3(0.032)\\
=&amp; 0.096
\end{align*}
\]</span></p>
<p>When the number of trials <span class="math inline">\(n\)</span> is large, it’s tedious to write out all the possible outcomes in the sample space. But there’s a formula you can use to find binomial probabilities for any <span class="math inline">\(n\)</span>.</p>
</section>
<section id="probabilities-for-a-binomial-distribution" class="level4">
<h4 class="anchored" data-anchor-id="probabilities-for-a-binomial-distribution">Probabilities for a Binomial Distribution</h4>
<p>Denote the probability of success on a trial by <span class="math inline">\(p\)</span>. For <span class="math inline">\(n\)</span> independent trials, the probability of <span class="math inline">\(x\)</span> successes equals <span class="math display">\[
P(x) = \binom{n}{x}p^x(1-p)^{n-x}, \qquad x=0, 1, 2, \ldots, n
\]</span> where <span class="math display">\[
\binom{n}{x}=\frac{n!}{x!(n-x)!}
\]</span></p>
<p>Let’s use this formula to find the probability that Doe would get only one correct in the previous section: <span class="math display">\[
\begin{align*}
    P(1) &amp;= \frac{3!}{1!(3-1)!}0.2^1(1-0.2)^{3-1}\\\\
   &amp; {=\frac{6}{1}0.2(0.8)^2}\\
   &amp;{ =.3840}
\end{align*}
\]</span></p>
</section>
<section id="check-to-see-if-binomial-conditions-apply" class="level4">
<h4 class="anchored" data-anchor-id="check-to-see-if-binomial-conditions-apply">Check to See If Binomial Conditions Apply</h4>
<p>Before you use the binomial distribution, check that its three conditions apply. These are</p>
<ol type="1">
<li>binary data (success or failure),</li>
<li>the same probability of success for each trial (denoted by <span class="math inline">\(p\)</span>), and</li>
<li>a fixed number <span class="math inline">\(n\)</span> of independent trials.</li>
</ol>
<p>One scenario where the assumptions do not apply is when sampling from a small population <blank>without replacement</blank>. When this occurs, the assumption of independence does not hold since the probability of success will change after each trial.</p>
<p><strong>Guideline: Population and Sample Sizes to Use the Binomial</strong> For sampling <span class="math inline">\(n\)</span> separate subjects from a population (that is, sampling without replacement), the exact probability distribution of the number of successes is too complex to discuss here, but the binomial distribution approximates it well when <span class="math inline">\(n\)</span> is less than 10% of the population size. In practice, sample sizes are usually small compared to population sizes, and this guideline is satisfied.</p>
</section>
<section id="mean-and-standard-deviation-of-the-binomial-distribution" class="level3">
<h3 class="anchored" data-anchor-id="mean-and-standard-deviation-of-the-binomial-distribution">Mean and Standard Deviation of the Binomial Distribution</h3>
<p>Recall that the formula for the expected value of a discrete random variable is <span class="math display">\[
E(X) = \mu = \sum xP(x)
\]</span></p>
<p>If we substitute in the binomial formula for <span class="math inline">\(P(x)\)</span> in the formula for expected value we get<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <span class="math display">\[
\begin{align*}
E(X) &amp;= \mu = \sum_{x=0}^n x \frac{n!}{x!(n-x)!}p^x(1-p)^{n-x}\\
&amp; {= np}
\end{align*}
\]</span></p>
<p>So if we know the random variable is binomial, the expected value is just <span class="math inline">\(E(X) =np\)</span>.</p>
<p>The same thing can be done for the variance. If we know the random variable is binomial, the variance and standard deviation are <span class="math display">\[
{\sigma^2=npq}\qquad\qquad{\sigma=\sqrt{npq}}
\]</span></p>
<section id="example-vaccine-side-effects" class="level4">
<h4 class="anchored" data-anchor-id="example-vaccine-side-effects">Example: vaccine side effects</h4>
<p>For a vaccine trial: each of 10 volunteers has a 0.2 probability of experiencing a side effect. Let <span class="math inline">\(X \sim \mathrm{Bin}(10, 0.2)\)</span> be the number of side effects. The probability of exactly <span class="math inline">\(x\)</span> side effects is <span class="math display">\[
P(X = x) = \binom{10}{x} 0.2^x 0.8^{10 - x}.
\]</span> For instance, the probability of exactly 3 participants experiencing side effects is <span class="math display">\[
\begin{align*}
P(X=3) =&amp; \binom{10}{3} (0.2)^3 (0.8)^{7}\\
=&amp; 120 \times 0.008 \times 0.2097152\\
\approx&amp; 0.2013
\end{align*}
\]</span> The expected number of side effects is <span class="math display">\[
E(X)=10\times 0.2=2
\]</span> and the standard deviation is <span class="math display">\[
\sigma = \sqrt{10 \times 0.2 \times 0.8}\approx 1.265
\]</span></p>
<p>A bar chart of the distribution shows that most of the probability mass is centered around 2:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-gene-carriers" class="level4">
<h4 class="anchored" data-anchor-id="example-gene-carriers">Example: gene carriers</h4>
<p>Suppose a particular allele is present in 10% of a plant population. If you examine 12 randomly selected plants, the number <span class="math inline">\(Y\)</span> of plants carrying the allele follows <span class="math inline">\(\mathrm{Bin}(n=12, p=0.10)\)</span>.</p>
<p>The probability of exactly <span class="math inline">\(x\)</span> carriers is <span class="math display">\[
\binom{12}{x} 0.1^x 0.9^{12-x}
\]</span><br>
The expected number of carriers is <span class="math inline">\(12 \times 0.10 = 1.2\)</span> and the standard deviation is <span class="math inline">\(\sqrt{12 \times 0.10 \times 0.90} \approx 1.039\)</span>.</p>
<p>The probability of <em>at least one</em> carrier is <span class="math display">\[
1 - P(Y=0) = 1 - (0.9)^{12} \approx 0.717
\]</span> meaning there is a 71.7% chance of finding at least one resistant plant in 12.</p>
</section>
<section id="counting-positive-results" class="level4">
<h4 class="anchored" data-anchor-id="counting-positive-results">Counting positive results</h4>
<p>Biologists often perform assays where each sample has a probability <span class="math inline">\(p\)</span> of yielding a positive result. If you test <span class="math inline">\(n\)</span> independent samples, the number of positives follows a binomial distribution. For example, if you test 6 fruit flies for a particular gene with presence rate 0.3, the distribution of <span class="math inline">\(X \sim \mathrm{Bin}(6, 0.3)\)</span> is:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P(X=x)\)</span></td>
<td><span class="math inline">\((0.7)^6\)</span></td>
<td><span class="math inline">\(6(0.3)(0.7)^5\)</span></td>
<td><span class="math inline">\(15(0.3^2)(0.7^4)\)</span></td>
<td>…</td>
<td>…</td>
<td>…</td>
<td><span class="math inline">\((0.3)^6\)</span></td>
</tr>
</tbody>
</table>
<p>The probabilities can be computed by hand or with software.</p>
</section>
</section>
<section id="working-in-jmp-pro-17-3" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17-3">Working in JMP Pro 17</h3>
<p>JMP has built‑in tools for the binomial distribution:</p>
<ol type="1">
<li><strong>Probability Calculator.</strong> Choose <strong>Help → Probability Calculator</strong>, select <em>Binomial</em> as the distribution, and specify <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>. You can then compute probabilities for specific values (e.g., <span class="math inline">\(P(X=3)\)</span>), cumulative probabilities (e.g., <span class="math inline">\(P(X \le 3)\)</span>), and tail probabilities (e.g., <span class="math inline">\(P(X \ge 5)\)</span>). The calculator displays both numerical results and a dynamic bar chart.</li>
<li><strong>Simulate binomial counts.</strong> Add a new column and set its formula to <code>Random Binomial(n, p)</code>. Generate many rows to see the empirical distribution, and analyse it with <strong>Distribution</strong>. This is a good way to build intuition for binomial variability.</li>
<li><strong>Expected value and standard deviation.</strong> JMP’s probability calculator reports the mean and standard deviation for the chosen <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>. You can also compute them manually using formula columns (<code>n*p</code> and <code>sqrt(n*p*(1-p))</code>).</li>
</ol>
</section>
<section id="recap-3" class="level3">
<h3 class="anchored" data-anchor-id="recap-3">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>binomial distribution</strong></td>
<td>The distribution of the number of successes in <span class="math inline">\(n\)</span> independent trials with success probability <span class="math inline">\(p\)</span>.</td>
</tr>
<tr class="even">
<td><strong>binomial pmf</strong></td>
<td><span class="math inline">\(P(X=x) = \binom{n}{x} p^x (1-p)^{n-x}\)</span> for <span class="math inline">\(x=0,\dots,n\)</span>.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding-3" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-3">Check your understanding</h3>
<ol type="1">
<li><p>An antibiotic cures a bacterial infection in 75 % of cases. In a study of 8 independent patients, let <span class="math inline">\(X\)</span> be the number of patients cured. Compute:</p>
<ol type="a">
<li><span class="math inline">\(P(X=6)\)</span>.<br>
</li>
<li><span class="math inline">\(P(X\le 4)\)</span>.<br>
</li>
<li><span class="math inline">\(E(X)\)</span> and <span class="math inline">\(\sigma\)</span></li>
</ol></li>
<li><p>A gene occurs in 15% of the population. You sample 10 individuals at random. What is the probability that exactly 2 individuals carry the gene? What is the probability that at least one individual carries the gene?<br>
</p></li>
<li><p>A researcher flips a biased coin (probability of heads is 0.6) 5 times. Does the number of heads follow a binomial distribution? Why or why not?<br>
</p></li>
<li><p>Describe a real‑world scenario where the binomial model would <strong>not</strong> be appropriate even though the outcome is a count of successes. Explain which assumption is violated.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Here <span class="math inline">\(X \sim \mathrm{Bin}(n=8,p=0.75)\)</span>. a) <span class="math inline">\(P(X=6) = \binom{8}{6} 0.75^6 0.25^2 = 28 \times 0.1779785 \times 0.0625 \approx 0.311\)</span>. b) <span class="math inline">\(P(X\le 4) = \sum_{x=0}^4 \binom{8}{x} 0.75^x 0.25^{8-x} \approx 0.0081\)</span> (you can compute this with a calculator or software). c) The mean is <span class="math inline">\(E(X)=8\times 0.75=6\)</span> and the standard deviation is <span class="math inline">\(\sigma_X=\sqrt{8\times 0.75 \times 0.25}=\sqrt{1.5}\approx 1.225\)</span>.<br>
</li>
<li>Let <span class="math inline">\(Y \sim \mathrm{Bin}(10,0.15)\)</span>. Then <span class="math inline">\(P(Y=2) = \binom{10}{2} (0.15)^2 (0.85)^8 \approx 45 \times 0.0225 \times 0.27249 \approx 0.276\)</span>. The probability of at least one carrier is <span class="math inline">\(1 - P(Y=0) = 1 - 0.85^{10} \approx 1 - 0.1969 = 0.8031\)</span>.<br>
</li>
<li>Yes. Each flip is a trial with two outcomes (heads or tails), the probability of heads is the same (0.6) on each flip, and the flips are assumed independent. Therefore the number of heads in 5 flips follows <span class="math inline">\(\mathrm{Bin}(5,0.6)\)</span>.<br>
</li>
<li>Suppose we sample 10 patients from a small village where tuberculosis is contagious and individuals tend to be exposed through one another. Let <span class="math inline">\(X\)</span> be the number of infected patients. Even if each individual infection has some probability <span class="math inline">\(p\)</span>, the infections are <strong>not independent</strong>: once one person is infected, the chance that their neighbor is infected rises. This dependence violates the independent‑trials assumption of the binomial model, so <span class="math inline">\(X\)</span> would not follow a binomial distribution.</li>
</ol>
</div>
</div>
</div>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>We will not prove this formula in this course. The proof does requires some algebra “tricks”.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>