<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>12&nbsp; Methods for Quantitative Response Variables – One and Two Groups – STA 2381 Introductory Statistical Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2ea2d3e7f2364fcda3d434693d3458e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style type="text/css">
.sidebar .chapter-number {
color: #FFB81c;
}
freeblank {
  color: transparent;
  cursor: pointer;
}
freeblank.clicked {
  color: red;
}
blank {
  display: inline-block; 
  position: relative;
  padding: 0 10px;
  color: transparent;
  cursor: pointer;
}
blank::before {
  content: ''; /* Creates a custom underline */
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 1px; /* Thickness of the underline */
  background-color: black; /* Color of the underline */
}
blank.clicked {
  color: red;
}
</style>
<script>
document.addEventListener('click', (event) => {
  if (event.target.tagName === 'BLANK') {
    event.target.classList.add('clicked');
  }
});
document.addEventListener('click', (event) => {
  if (event.target.tagName === 'FREEBLANK') {
    event.target.classList.add('clicked');
  }
});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./12.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Methods for Quantitative Response Variables – One and Two Groups</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Collecting Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Describing Data with Tables and Graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Describing Data with Numbers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sampling Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation and Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesis Testing: The Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis Testing with Categorical Response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Methods for Quantitative Response Variables – One and Two Groups</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#onesample-tests-for-the-mean-and-variance" id="toc-onesample-tests-for-the-mean-and-variance" class="nav-link active" data-scroll-target="#onesample-tests-for-the-mean-and-variance"><span class="header-section-number">12.1</span> One‑Sample Tests for the Mean and Variance</a>
  <ul class="collapse">
  <li><a href="#onesample-ttest-for-a-mean" id="toc-onesample-ttest-for-a-mean" class="nav-link" data-scroll-target="#onesample-ttest-for-a-mean">One‑sample t‑test for a mean</a></li>
  <li><a href="#chisquare-test-for-a-variance" id="toc-chisquare-test-for-a-variance" class="nav-link" data-scroll-target="#chisquare-test-for-a-variance">Chi‑square test for a variance</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#check-your-understanding" id="toc-check-your-understanding" class="nav-link" data-scroll-target="#check-your-understanding">Check your understanding</a></li>
  </ul></li>
  <li><a href="#two-independent-samples-students-ttest-and-welchs-ttest" id="toc-two-independent-samples-students-ttest-and-welchs-ttest" class="nav-link" data-scroll-target="#two-independent-samples-students-ttest-and-welchs-ttest"><span class="header-section-number">12.2</span> Two Independent Samples: Student’s t‑Test and Welch’s t‑Test</a>
  <ul class="collapse">
  <li><a href="#students-pooled-ttest" id="toc-students-pooled-ttest" class="nav-link" data-scroll-target="#students-pooled-ttest">Student’s (pooled) t‑test</a></li>
  <li><a href="#welchs-nonpooled-ttest-unequal-variances" id="toc-welchs-nonpooled-ttest-unequal-variances" class="nav-link" data-scroll-target="#welchs-nonpooled-ttest-unequal-variances">Welch’s (nonpooled) t‑test (unequal variances)</a></li>
  <li><a href="#assumptions-and-choosing-the-test" id="toc-assumptions-and-choosing-the-test" class="nav-link" data-scroll-target="#assumptions-and-choosing-the-test">Assumptions and choosing the test</a></li>
  <li><a href="#example-ad-campaign-effectiveness" id="toc-example-ad-campaign-effectiveness" class="nav-link" data-scroll-target="#example-ad-campaign-effectiveness">Example – Ad campaign effectiveness</a></li>
  <li><a href="#performing-the-twosample-tests-in-jmp-18" id="toc-performing-the-twosample-tests-in-jmp-18" class="nav-link" data-scroll-target="#performing-the-twosample-tests-in-jmp-18">Performing the two‑sample tests in JMP 18</a></li>
  <li><a href="#recap-1" id="toc-recap-1" class="nav-link" data-scroll-target="#recap-1">Recap</a></li>
  <li><a href="#check-your-understanding-1" id="toc-check-your-understanding-1" class="nav-link" data-scroll-target="#check-your-understanding-1">Check your understanding</a></li>
  </ul></li>
  <li><a href="#equality-of-variances-ftest-and-alternatives" id="toc-equality-of-variances-ftest-and-alternatives" class="nav-link" data-scroll-target="#equality-of-variances-ftest-and-alternatives"><span class="header-section-number">12.3</span> Equality of Variances: F‑Test and Alternatives</a>
  <ul class="collapse">
  <li><a href="#test-statistic-and-assumptions" id="toc-test-statistic-and-assumptions" class="nav-link" data-scroll-target="#test-statistic-and-assumptions">Test statistic and assumptions</a></li>
  <li><a href="#confidence-interval-for-the-ratio-of-variances" id="toc-confidence-interval-for-the-ratio-of-variances" class="nav-link" data-scroll-target="#confidence-interval-for-the-ratio-of-variances">Confidence interval for the ratio of variances</a></li>
  <li><a href="#example-enzyme-activity-variability-biology" id="toc-example-enzyme-activity-variability-biology" class="nav-link" data-scroll-target="#example-enzyme-activity-variability-biology">Example – Enzyme activity variability (biology)</a></li>
  <li><a href="#performing-the-ftest-in-jmp-18" id="toc-performing-the-ftest-in-jmp-18" class="nav-link" data-scroll-target="#performing-the-ftest-in-jmp-18">Performing the F‑test in JMP 18</a></li>
  <li><a href="#recap-2" id="toc-recap-2" class="nav-link" data-scroll-target="#recap-2">Recap</a></li>
  <li><a href="#check-your-understanding-2" id="toc-check-your-understanding-2" class="nav-link" data-scroll-target="#check-your-understanding-2">Check your understanding</a></li>
  </ul></li>
  <li><a href="#paired-samples-matchedpairs-ttest" id="toc-paired-samples-matchedpairs-ttest" class="nav-link" data-scroll-target="#paired-samples-matchedpairs-ttest"><span class="header-section-number">12.4</span> Paired Samples: Matched‑Pairs t‑Test</a>
  <ul class="collapse">
  <li><a href="#setting-up-the-problem" id="toc-setting-up-the-problem" class="nav-link" data-scroll-target="#setting-up-the-problem">Setting up the problem</a></li>
  <li><a href="#matchedpairs-ttest" id="toc-matchedpairs-ttest" class="nav-link" data-scroll-target="#matchedpairs-ttest">Matched‑pairs t‑test</a></li>
  <li><a href="#paired-t-test-in-jmp" id="toc-paired-t-test-in-jmp" class="nav-link" data-scroll-target="#paired-t-test-in-jmp">Paired t-test in JMP</a></li>
  <li><a href="#recap-3" id="toc-recap-3" class="nav-link" data-scroll-target="#recap-3">Recap</a></li>
  <li><a href="#check-your-understanding-3" id="toc-check-your-understanding-3" class="nav-link" data-scroll-target="#check-your-understanding-3">Check your understanding</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Methods for Quantitative Response Variables – One and Two Groups</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>“It’s easy to lie with statistics. It’s hard to tell the truth without statistics.” – Andrejs Dunkels</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Guiding question:</strong> <em>When our response variable is numerical, how do we choose the right test based on the type and number of explanatory variables?</em></p>
</blockquote>
<p>In the previous chapter we focused on categorical outcomes. Here our response variable is <blank>quantitative</blank>, meaning it is measured on a numeric scale such as weight, blood pressure, cholesterol level, enzyme activity, revenue or time. To decide on an appropriate analysis we must consider how many explanatory variables we have and whether the data are paired or independent. The table below summarizes the situations covered in this chapter:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Scenario</strong></th>
<th><strong>Response variable</strong></th>
<th><strong>Explanatory variable</strong></th>
<th><strong>Appropriate method</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>No explanatory variable</strong></td>
<td>Quantitative</td>
<td>None (one sample)</td>
<td>One‑sample t‑test for the mean and chi‑square test for the variance</td>
</tr>
<tr class="even">
<td><strong>Two paired measurements</strong></td>
<td>Quantitative</td>
<td>One categorical variable with two <strong>matched</strong> levels (e.g., before/after on the same subject)</td>
<td>Paired t‑test</td>
</tr>
<tr class="odd">
<td><strong>Two independent groups</strong></td>
<td>Quantitative</td>
<td>One categorical variable with two <strong>independent</strong> levels (e.g., treatment vs.&nbsp;control)</td>
<td>Two‑sample t‑test for means (pooled or Welch) and F‑test for equality of variances</td>
</tr>
</tbody>
</table>
<section id="onesample-tests-for-the-mean-and-variance" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="onesample-tests-for-the-mean-and-variance"><span class="header-section-number">12.1</span> One‑Sample Tests for the Mean and Variance</h2>
<p>When there is no explanatory variable, we have a single quantitative sample. Two natural questions arise:</p>
<ol type="1">
<li><em>Is the population mean equal to a specified value?</em></li>
<li><em>Is the population variance equal to a specified value?</em></li>
</ol>
<p>We address these with the one‑sample <em>t</em>-test and the chi‑square test for the variance.</p>
<p><img src="images/09.png" class="img-fluid"></p>
<section id="onesample-ttest-for-a-mean" class="level3">
<h3 class="anchored" data-anchor-id="onesample-ttest-for-a-mean">One‑sample t‑test for a mean</h3>
<p>Suppose we have a random sample <span class="math inline">\(x_1, x_2,\dots,x_n\)</span> from a population with unknown mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>. We want to test</p>
<p><span class="math display">\[
\begin{align*}
&amp;H_0: \mu = \mu_0 \\
&amp;H_a: \mu \neq \mu_0\quad (\text{or } \mu &gt; \mu_0,\ \mu &lt; \mu_0)
\end{align*}
\]</span></p>
<section id="assumptions" class="level4">
<h4 class="anchored" data-anchor-id="assumptions">Assumptions</h4>
<p>Like all inference methods, the t‑test rests on assumptions. In practice we require:</p>
<ul>
<li>A <em>simple random sample</em> from the population of interest; observations are independent of one another.</li>
<li>The population is <blank>normally</blank> distributed, or the sample size is large (typically <span class="math inline">\(n \ge 30\)</span>) so that the Central Limit Theorem ensures approximate normality.</li>
</ul>
</section>
<section id="test-statistic-and-pvalue" class="level4">
<h4 class="anchored" data-anchor-id="test-statistic-and-pvalue">Test statistic and p‑value</h4>
<p>Under <span class="math inline">\(H_0\)</span>, the test statistic</p>
<p><span class="math display">\[
t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}}
\]</span></p>
<p>follows a Student’s <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n-1\)</span> degrees of freedom. We obtain the p‑value by comparing the observed <span class="math inline">\(|t|\)</span> to the <span class="math inline">\(t\)</span> distribution. For a two‑sided alternative the p‑value is <span class="math inline">\(2P(T_{n-1} &gt; |t|)\)</span>; for a one‑sided alternative we compute <span class="math inline">\(P(T_{n-1} &gt; t)\)</span> or <span class="math inline">\(P(T_{n-1} &lt; t)\)</span> depending on the direction.</p>
</section>
<section id="confidence-interval" class="level4">
<h4 class="anchored" data-anchor-id="confidence-interval">Confidence interval</h4>
<p>When the test is significant (or even when it is not), a <span class="math inline">\((1-\alpha)\times100\%\)</span> confidence interval for <span class="math inline">\(\mu\)</span> gives a range of plausible values. The interval is</p>
<p><span class="math display">\[
\bar{x} \pm t_{\alpha/2}\,\frac{s}{\sqrt{n}},
\]</span></p>
<p>where <span class="math inline">\(t_{\alpha/2}\)</span> is the critical value from the <span class="math inline">\(t\)</span> distribution.</p>
</section>
<section id="example-leaf-nitrogen-content" class="level4">
<h4 class="anchored" data-anchor-id="example-leaf-nitrogen-content">Example – Leaf nitrogen content</h4>
<p>In a nutrient study a botanist measures the nitrogen content (in % dry weight) of 15 leaves from a wildflower species. The sample mean is 3.4% with a standard deviation of 0.6%. Test whether the mean differs from 3.0% at the 5% significance level.</p>
<p><strong>Solution.</strong> The hypotheses are <span class="math inline">\(H_0: \mu = 3.0\)</span> vs.&nbsp;<span class="math inline">\(H_a: \mu \neq 3.0\)</span>. The test statistic is</p>
<p><span class="math display">\[
t = \frac{3.4 - 3.0}{0.6/\sqrt{15}} \approx 2.58.
\]</span></p>
<p>With <span class="math inline">\(n-1 = 14\)</span> degrees of freedom the two‑sided p‑value is <span class="math inline">\(2P(T_{14} &gt; 2.58) \approx 0.021\)</span>. Since 0.021 &lt; 0.05, we reject <span class="math inline">\(H_0\)</span> and conclude that mean nitrogen content differs from 3.0%. A 95% confidence interval is <span class="math inline">\(3.4 \pm t_{0.025,14}\times0.6/\sqrt{15} = (3.05, 3.75)\)</span>.</p>
</section>
<section id="performing-the-onesample-mean-test-in-jmp-18" class="level4">
<h4 class="anchored" data-anchor-id="performing-the-onesample-mean-test-in-jmp-18">Performing the one‑sample mean test in JMP 18</h4>
<p>To carry out this test in <strong>JMP 18 Student Edition</strong>:</p>
<ol type="1">
<li><strong>Enter the data.</strong> Create a column for the quantitative variable (e.g., “HeartRate”).</li>
<li><strong>Launch the Distribution platform.</strong> Select <code>Analyze → Distribution</code>, assign the variable to <strong>Y</strong>, and click OK. JMP displays summary statistics and a histogram.</li>
<li><strong>Test the mean.</strong> Click the red triangle next to the variable name and choose <strong>Test Mean</strong>. Enter the hypothesized value <span class="math inline">\(\mu_0\)</span> and specify the alternative (two‑sided or one‑sided). JMP reports the <span class="math inline">\(t\)</span> statistic, degrees of freedom, and p‑value. The same dialog box allows you to request a confidence interval.</li>
</ol>
</section>
</section>
<section id="chisquare-test-for-a-variance" class="level3">
<h3 class="anchored" data-anchor-id="chisquare-test-for-a-variance">Chi‑square test for a variance</h3>
<p>Sometimes we are interested in assessing whether the population variance equals a specified value <span class="math inline">\(\sigma_0^2\)</span>. For example, an engineer may want to know whether the variability of machine parts exceeds a tolerance level. Let <span class="math inline">\(s^2\)</span> be the sample variance computed from a random sample of size <span class="math inline">\(n\)</span>. To test</p>
<p><span class="math display">\[
\begin{align*}
&amp;H_0: \sigma^2 = \sigma_0^2\\
&amp;H_a: \sigma^2 \neq \sigma_0^2 \quad (\text{or } &gt;, &lt;)
\end{align*}
\]</span></p>
<p>we use the test statistic</p>
<p><span class="math display">\[
\chi^2 = \frac{(n-1)s^2}{\sigma_0^2},
\]</span></p>
<p>which has a chi‑square distribution with <span class="math inline">\(n-1\)</span> degrees of freedom under <span class="math inline">\(H_0\)</span>. Large values of <span class="math inline">\(\chi^2\)</span> indicate that <span class="math inline">\(s^2\)</span> is bigger than expected under <span class="math inline">\(H_0\)</span>; small values indicate it is too small. For a two‑sided alternative the p‑value is <span class="math inline">\(P(\chi^2_{n-1} &gt; \chi^2_\text{obs})\)</span> for one tail plus <span class="math inline">\(P(\chi^2_{n-1} &lt; \chi^2_\text{obs})\)</span> for the other.</p>
<section id="confidence-interval-1" class="level4">
<h4 class="anchored" data-anchor-id="confidence-interval-1">Confidence interval</h4>
<p>A <span class="math inline">\((1-\alpha)\times100\%\)</span> confidence interval for the population variance is</p>
<p><span class="math display">\[
\left(\frac{(n-1)s^2}{\chi^2_{1-\alpha/2}},\ \frac{(n-1)s^2}{\chi^2_{\alpha/2}}\right),
\]</span></p>
<p>where <span class="math inline">\(\chi^2_{\alpha/2, n-1}\)</span> and <span class="math inline">\(\chi^2_{1-\alpha/2, n-1}\)</span> are critical values from the chi‑square distribution. Taking square roots yields a confidence interval for the standard deviation.</p>
</section>
<section id="example-manufacturing-variability" class="level4">
<h4 class="anchored" data-anchor-id="example-manufacturing-variability">Example – Manufacturing variability</h4>
<p>A company manufactures springs with a target variance in spring length of <span class="math inline">\(\sigma_0^2 = 0.04\ \mathrm{cm}^2\)</span>. A quality‑control engineer measures 25 springs and computes a sample variance of <span class="math inline">\(s^2 = 0.065\ \mathrm{cm}^2\)</span>. Test whether the variance differs from the target at the 5% level.</p>
<p><strong>Solution.</strong> With <span class="math inline">\(n-1 = 24\)</span> degrees of freedom, the test statistic is <span class="math display">\[
\begin{align*}
\chi^2 &amp;= \frac{(24)(0.065)}{0.04}\\
&amp;= 39.0
\end{align*}
\]</span><br>
For a two‑sided test, the p‑value is about <span class="math inline">\(2P(\chi^2&gt;39.0)=0.055\)</span>. We fail to reject <span class="math inline">\(H_0\)</span>. A 95% confidence interval for <span class="math inline">\(\sigma^2\)</span> is</p>
<p><span class="math display">\[
\left(\frac{24\times0.065}{39.4},\ \frac{24\times0.065}{12.4}\right) = (0.0396, 0.1256),
\]</span></p>
<p>so the variance may range from 0.04 to 0.13 cm².</p>
</section>
<section id="performing-the-variance-test-in-jmp-18" class="level4">
<h4 class="anchored" data-anchor-id="performing-the-variance-test-in-jmp-18">Performing the variance test in JMP 18</h4>
<p>There is no dedicated “chi‑square test for variance” command in JMP. However, you can assess variability through graphical tools and by constructing the confidence interval manually. To do this:</p>
<ol type="1">
<li>Compute the sample variance <span class="math inline">\(s^2\)</span> and degrees of freedom <span class="math inline">\(n-1\)</span>.</li>
<li>Find the critical chi‑square values using a table or the distribution calculator in JMP (<code>Analyze → Distribution → Continuous Distribution</code>).</li>
<li>Plug into the confidence interval formula above.</li>
</ol>
</section>
</section>
<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword/Concept</strong></th>
<th><strong>Definition/Formula</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>One‑sample t‑test</strong></td>
<td>Tests <span class="math inline">\(H_0: \mu=\mu_0\)</span> using <span class="math inline">\(t = (\bar{x}-\mu_0)/(s/\sqrt{n})\)</span> with <span class="math inline">\(n-1\)</span> df.</td>
</tr>
<tr class="even">
<td><strong>Confidence interval for mean</strong></td>
<td><span class="math inline">\(\bar{x} \pm t_{\alpha/2,n-1} \times s/\sqrt{n}\)</span>.</td>
</tr>
<tr class="odd">
<td><strong>Chi‑square test for variance</strong></td>
<td>Tests <span class="math inline">\(H_0: \sigma^2 = \sigma_0^2\)</span> using <span class="math inline">\(\chi^2 = (n-1)s^2/\sigma_0^2\)</span> with <span class="math inline">\(n-1\)</span> df.</td>
</tr>
<tr class="even">
<td><strong>Confidence interval for variance</strong></td>
<td><span class="math inline">\(\left(\frac{(n-1)s^2}{\chi^2_{1-\alpha/2,n-1}},\ \frac{(n-1)s^2}{\chi^2_{\alpha/2,n-1}}\right)\)</span>.</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="check-your-understanding" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding">Check your understanding</h3>
<ol type="1">
<li>The caffeine content of a new energy drink is claimed to be 80 mg per can. In a lab study 12 cans have a mean caffeine level of 77 mg and a standard deviation of 5 mg. At <span class="math inline">\(\alpha=0.05\)</span> test whether the average caffeine content differs from 80 mg and compute a 95% confidence interval.</li>
<li>A plant geneticist measures the variance in seed weight for a hybrid strain and obtains <span class="math inline">\(s^2=0.25\,\text{g}^2\)</span> from <span class="math inline">\(n=16\)</span> seeds. Test whether the true variance differs from 0.20 g² at <span class="math inline">\(\alpha=0.10\)</span>.</li>
<li>Why does the t‑test for the mean use the sample standard deviation <span class="math inline">\(s\)</span> in the denominator instead of the known standard deviation <span class="math inline">\(\sigma\)</span>?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Test of the mean:</strong> <span class="math inline">\(H_0: \mu=80\)</span> vs.&nbsp;<span class="math inline">\(H_a: \mu\neq80\)</span>. Here <span class="math inline">\(\bar{x}=77\)</span>, <span class="math inline">\(s=5\)</span> and <span class="math inline">\(n=12\)</span>, so <span class="math inline">\(t=(77-80)/(5/\sqrt{12})\approx-2.08\)</span>. With <span class="math inline">\(n-1=11\)</span> df the two‑sided p‑value is <span class="math inline">\(2P(T_{11}&gt;2.08)\approx0.062\)</span>. At <span class="math inline">\(\alpha=0.05\)</span> we <strong>fail</strong> to reject <span class="math inline">\(H_0\)</span>. A 95% CI is <span class="math inline">\(77 \pm t_{0.025,11}\times5/\sqrt{12}=(73.0,81.0)\)</span>; this interval contains 80 mg.</li>
<li>With <span class="math inline">\(n-1=15\)</span> df the test statistic is <span class="math inline">\(\chi^2=(15\times0.25)/0.20=18.75\)</span>. The critical values at <span class="math inline">\(\alpha=0.10\)</span> are <span class="math inline">\(\chi^2_{0.95,15}\approx7.26\)</span> and <span class="math inline">\(\chi^2_{0.05,15}\approx24.99\)</span>. Since 18.75 lies between these, we fail to reject <span class="math inline">\(H_0\)</span>. The data do not provide enough evidence that the variance differs from 0.20 g².</li>
<li>In practice we rarely know the population standard deviation <span class="math inline">\(\sigma\)</span>. The t‑test treats <span class="math inline">\(s\)</span> as an estimate of <span class="math inline">\(\sigma\)</span>. Using <span class="math inline">\(s\)</span> introduces additional uncertainty, so the sampling distribution becomes a t distribution rather than a normal distribution.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="two-independent-samples-students-ttest-and-welchs-ttest" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="two-independent-samples-students-ttest-and-welchs-ttest"><span class="header-section-number">12.2</span> Two Independent Samples: Student’s t‑Test and Welch’s t‑Test</h2>
<p>When comparing means between two <blank>independent</blank> groups, the appropriate procedure depends on whether the population variances are equal. We consider two methods: the pooled (Student’s) t‑test and Welch’s t‑test.</p>
<p><img src="images/11.png" class="img-fluid"></p>
<section id="students-pooled-ttest" class="level3">
<h3 class="anchored" data-anchor-id="students-pooled-ttest">Student’s (pooled) t‑test</h3>
<p>Let <span class="math inline">\(x_{1i}\)</span> and <span class="math inline">\(x_{2j}\)</span> be independent random samples from populations with means <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> and common variance <span class="math inline">\(\sigma^2\)</span>. To test <span class="math display">\[
\begin{align*}
&amp;H_0: \mu_1 = \mu_2\\
&amp;H_a: \mu_1 \neq \mu_2
\qquad\text{(or one‑sided)}
\end{align*}
\]</span></p>
<p>we compute</p>
<ol type="1">
<li>Pooled estimate of variance:</li>
</ol>
<p><span class="math display">\[
s_p^2 = \frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}
\]</span></p>
<ol start="2" type="1">
<li>Test statistic:</li>
</ol>
<p><span class="math display">\[
t = \frac{\bar{x}_1 - \bar{x}_2}{s_p\sqrt{1/n_1 + 1/n_2}}
\]</span></p>
<p>The statistic follows a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n_1 + n_2 - 2\)</span> degrees of freedom. Assumptions include:</p>
<ul>
<li>Two independent random samples.</li>
<li>Each population is approximately normally distributed.</li>
<li>The population variances are <blank>equal</blank> (<span class="math inline">\(\sigma_1^2 = \sigma_2^2\)</span>).</li>
</ul>
<p>A <span class="math inline">\((1-\alpha)\times100\%\)</span> confidence interval for <span class="math inline">\(\mu_1 - \mu_2\)</span> is</p>
<p><span class="math display">\[
(\bar{x}_1 - \bar{x}_2) \pm t_{\alpha/2,}\,s_p \sqrt{1/n_1 + 1/n_2}.
\]</span></p>
</section>
<section id="welchs-nonpooled-ttest-unequal-variances" class="level3">
<h3 class="anchored" data-anchor-id="welchs-nonpooled-ttest-unequal-variances">Welch’s (nonpooled) t‑test (unequal variances)</h3>
<p>When the assumption of equal variances is violated, we use Welch’s t‑test (also called the nonpooled t-test). This test modifies the standard error and the degrees of freedom. The test statistic is</p>
<p><span class="math display">\[
t = \frac{\bar{x}_1 - \bar{x}_2}{\sqrt{s_1^2/n_1 + s_2^2/n_2}},
\]</span></p>
<p>and the degrees of freedom are approximated by</p>
<p><span class="math display">\[
\nu = \frac{\left(\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}\right)^2}{\frac{(s_1^2/n_1)^2}{n_1 - 1} + \frac{(s_2^2/n_2)^2}{n_2 - 1}}.
\]</span></p>
<p>This formula yields a non‑integer value; software uses it to compute the p‑value. The confidence interval for <span class="math inline">\(\mu_1 - \mu_2\)</span> uses the same standard error and the <span class="math inline">\(t_{\nu}\)</span> distribution.</p>
</section>
<section id="assumptions-and-choosing-the-test" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-and-choosing-the-test">Assumptions and choosing the test</h3>
<p>The assumptions for two‑sample t‑tests: the groups must be independent, each sample should come from a normal distribution, and the variances should be equal for the pooled test. If variances are not equal, the Welch test is preferred. <strong>In practice, Welch’s t-test should be used by default unless it is known the variances are equal.</strong></p>
</section>
<section id="example-ad-campaign-effectiveness" class="level3">
<h3 class="anchored" data-anchor-id="example-ad-campaign-effectiveness">Example – Ad campaign effectiveness</h3>
<p>A marketing analyst compares sales increases after two different advertising campaigns. Sales increases for 20 regions under campaign A have mean 1.8% and SD = 1.0%; for 18 regions under campaign B the mean is 1.2% with SD = 0.6%. We do not know if the population variances are equal so we use Welch’s t-test:</p>
<p><span class="math display">\[
t = \frac{1.8 - 1.2}{\sqrt{1.0^2/20 + 0.6^2/18}} = 2.17.
\]</span></p>
<p>The Welch degrees of freedom are</p>
<p><span class="math display">\[
\nu = \frac{\left(\frac{1.0^2}{20} + \frac{0.6^2}{18}\right)^2}{\frac{(1.0^2/20)^2}{19} + \frac{(0.6^2/18)^2}{17}} \approx 31.
\]</span></p>
<p>With <span class="math inline">\(\nu\approx31\)</span> df, the two‑sided p‑value is 0.036. We reject <span class="math inline">\(H_0\)</span>; campaign A yields a greater increase in sales. A 95% CI for the difference is <span class="math inline">\((0.037, 1.163)\)</span> percentage points.</p>
</section>
<section id="performing-the-twosample-tests-in-jmp-18" class="level3">
<h3 class="anchored" data-anchor-id="performing-the-twosample-tests-in-jmp-18">Performing the two‑sample tests in JMP 18</h3>
<ol type="1">
<li><strong>Organize the data.</strong> Each row corresponds to an observation; include a response column and a group column.</li>
<li><strong>Fit Y by X.</strong> Choose <code>Analyze → Fit Y by X</code>, assign the response variable to <strong>Y</strong> and the group to <strong>X</strong>, and click OK.</li>
<li><strong>Pooled t‑test (equal variances).</strong> From the red triangle select <strong>Means/ANOVA/Pooled t</strong>. JMP reports the pooled t statistic, p‑value and confidence interval.</li>
<li><strong>Unequal variances t‑test (Welch).</strong> From the red triangle select <strong>Unequal Variances</strong>. At the bottom of the report JMP presents the Welch t‑test results; use these when variances differ or by default for robustness.</li>
</ol>
</section>
<section id="recap-1" class="level3">
<h3 class="anchored" data-anchor-id="recap-1">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword/Concept</strong></th>
<th><strong>Definition/Formula</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Pooled t‑test</strong></td>
<td>Tests <span class="math inline">\(H_0: \mu_1=\mu_2\)</span> assuming equal variances; statistic <span class="math inline">\(t=(\bar{x}_1-\bar{x}_2)/(s_p\sqrt{1/n_1+1/n_2})\)</span> with df <span class="math inline">\(n_1+n_2-2\)</span>.</td>
</tr>
<tr class="even">
<td><strong>Welch’s (nonpooled) t‑test</strong></td>
<td>Tests <span class="math inline">\(H_0: \mu_1=\mu_2\)</span> without assuming equal variances; statistic <span class="math inline">\((\bar{x}_1-\bar{x}_2)/\sqrt{s_1^2/n_1+s_2^2/n_2}\)</span> with approximate df given by Welch’s formula.</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="check-your-understanding-1" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-1">Check your understanding</h3>
<ol type="1">
<li>Researchers compare the mean glucose levels of two independent groups of mice (n = 15 per group). Group 1 has <span class="math inline">\(\bar{x}_1=110\,\text{mg/dL}\)</span> and <span class="math inline">\(s_1=12\)</span>; Group 2 has <span class="math inline">\(\bar{x}_2=103\,\text{mg/dL}\)</span> and <span class="math inline">\(s_2=15\)</span>. Assume equal variances in the populations. Test whether the mean glucose levels differ at the 5% level and compute a 95% confidence interval for the difference.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Since the F‑test is not significant, we use the pooled t‑test. The pooled standard deviation is <span class="math inline">\(s_p=\sqrt{(14\times12^2+14\times15^2)/28}=13.54\)</span>. The test statistic is <span class="math inline">\(t=(110-103)/(13.54\sqrt{1/15+1/15})=1.52\)</span> with df = 28; the two‑sided p‑value is 0.14. We fail to reject <span class="math inline">\(H_0\)</span>; the mean glucose levels do not differ significantly. A 95% CI is <span class="math inline">\((110-103) \pm t_{0.025,28}\,13.54\sqrt{2/15} = (-2.56, 16.56)\)</span> mg/dL.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="equality-of-variances-ftest-and-alternatives" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="equality-of-variances-ftest-and-alternatives"><span class="header-section-number">12.3</span> Equality of Variances: F‑Test and Alternatives</h2>
<p><img src="images/12.png" class="img-fluid"></p>
<p>The <em>F‑test</em> compares two sample variances to evaluate</p>
<p><span class="math display">\[
H_0: \sigma_1^2 = \sigma_2^2 \quad\text{vs.}\quad H_a: \sigma_1^2 \neq \sigma_2^2.
\]</span></p>
<section id="test-statistic-and-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="test-statistic-and-assumptions">Test statistic and assumptions</h3>
<p>Let <span class="math inline">\(s_1^2\)</span> and <span class="math inline">\(s_2^2\)</span> be the sample variances from independent random samples of sizes <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> drawn from normally distributed populations. Without loss of generality assume <span class="math inline">\(s_1^2 \ge s_2^2\)</span>. The test statistic</p>
<p><span class="math display">\[
F = \frac{s_1^2}{s_2^2}
\]</span></p>
<p>has an F distribution with <span class="math inline">\((n_1-1, n_2-1)\)</span> degrees of freedom under <span class="math inline">\(H_0\)</span>. Large values of <span class="math inline">\(F\)</span> indicate that <span class="math inline">\(s_1^2\)</span> is much larger than <span class="math inline">\(s_2^2\)</span>; very small values (which correspond to <span class="math inline">\(s_2^2\)</span> being larger) are captured by the symmetry of the F distribution.</p>
<p>Assumptions include:</p>
<ul>
<li>Two independent random samples.</li>
<li>Each population is normally distributed. The F‑test is sensitive to departures from normality, so a normality check is essential.</li>
</ul>
</section>
<section id="confidence-interval-for-the-ratio-of-variances" class="level3">
<h3 class="anchored" data-anchor-id="confidence-interval-for-the-ratio-of-variances">Confidence interval for the ratio of variances</h3>
<p>We can estimate the ratio of population variances <span class="math inline">\(\sigma_1^2/\sigma_2^2\)</span> using the sample ratio <span class="math inline">\(F\)</span> and obtain a <span class="math inline">\((1-\alpha)\times100\%\)</span> confidence interval:</p>
<p><span class="math display">\[
\left(\frac{s_1^2}{s_2^2}\times\frac{1}{F_{\alpha/2,\,n_1-1,\,n_2-1}},\ \frac{s_1^2}{s_2^2}\times\frac{1}{F_{1-\alpha/2,\,n_1-1,\,n_2-1}}\right).
\]</span></p>
</section>
<section id="example-enzyme-activity-variability-biology" class="level3">
<h3 class="anchored" data-anchor-id="example-enzyme-activity-variability-biology">Example – Enzyme activity variability (biology)</h3>
<p>Two species of bacteria are tested for variability in an enzyme’s activity. For species A (<span class="math inline">\(n_1=10\)</span>) the sample variance is <span class="math inline">\(s_1^2=0.08\)</span>; for species B (<span class="math inline">\(n_2=12\)</span>) <span class="math inline">\(s_2^2=0.03\)</span>. With <span class="math inline">\(s_1^2 &gt; s_2^2\)</span>, the test statistic is <span class="math inline">\(F=0.08/0.03=2.67\)</span>. Degrees of freedom are <span class="math inline">\((9,11)\)</span>. Using software, we find <span class="math inline">\(P(F_{9,11}&gt;2.67)\approx0.08\)</span>. The two‑sided p‑value is <span class="math inline">\(2\times0.08=0.16\)</span>. We fail to reject <span class="math inline">\(H_0\)</span>; the variances are not significantly different. A 95% CI for <span class="math inline">\(\sigma_1^2/\sigma_2^2\)</span> would be computed using the formula above.</p>
</section>
<section id="performing-the-ftest-in-jmp-18" class="level3">
<h3 class="anchored" data-anchor-id="performing-the-ftest-in-jmp-18">Performing the F‑test in JMP 18</h3>
<ol type="1">
<li><strong>Prepare data.</strong> Create a column for the quantitative response and a column for the group indicator (e.g., “Species”).</li>
<li><strong>Fit Y by X.</strong> Choose <code>Analyze → Fit Y by X</code>, assign the response to <strong>Y</strong> and the group to <strong>X</strong>, and click OK.</li>
<li><strong>Unequal Variances.</strong> Click the red triangle next to “Fit Y by X” and select <strong>Unequal Variances</strong>. JMP displays tests such as Levene’s and Bartlett’s along with the F‑ratio.</li>
</ol>
<p>If the normality assumption is doubtful, use a robust alternative such as Levene’s test (also available in the <strong>Unequal Variances</strong> output).</p>
</section>
<section id="recap-2" class="level3">
<h3 class="anchored" data-anchor-id="recap-2">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword/Concept</strong></th>
<th><strong>Definition/Formula</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>F‑test</strong></td>
<td>Tests <span class="math inline">\(H_0: \sigma_1^2=\sigma_2^2\)</span> with statistic <span class="math inline">\(F=s_1^2/s_2^2\)</span>.</td>
</tr>
<tr class="even">
<td><strong>Confidence interval for variance ratio</strong></td>
<td><span class="math inline">\(\big(\frac{s_1^2}{s_2^2}/F_{\alpha/2},\ \frac{s_1^2}{s_2^2}/F_{1-\alpha/2}\big)\)</span> for df <span class="math inline">\((n_1-1,n_2-1)\)</span>.</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="check-your-understanding-2" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-2">Check your understanding</h3>
<ol type="1">
<li>Two laboratories measure the variability of protein concentrations in a sample. Lab 1 obtains <span class="math inline">\(s_1^2=0.20\)</span> (n = 8) and Lab 2 obtains <span class="math inline">\(s_2^2=0.11\)</span> (n = 10). Test at <span class="math inline">\(\alpha=0.05\)</span> whether the variances differ.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>With degrees of freedom <span class="math inline">\((7,9)\)</span> the F statistic is <span class="math inline">\(F=0.20/0.11=1.82\)</span>. The two‑sided p‑value is <span class="math inline">\(2\min\{P(F_{7,9}&gt;1.82),\ P(F_{7,9}&lt;1/1.82)\}=2\times0.20=0.40\)</span>. We fail to reject <span class="math inline">\(H_0\)</span>; there is no evidence of unequal variances.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="paired-samples-matchedpairs-ttest" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="paired-samples-matchedpairs-ttest"><span class="header-section-number">12.4</span> Paired Samples: Matched‑Pairs t‑Test</h2>
<p>Suppose we want to compare two methods of teaching reading to “slow learners”. Suppose it is possible to measure the “reading IQs” of the “slow learners” before they are subjected to a teaching method.</p>
<p>Eight pairs of “slow learners” with similar reading IQs are found, and one member of each pair is randomly assigned to the standard teaching method while the other is assigned to the new method.</p>
<p>The data are below and can be found in <code>PAIREDSCORES.jmp</code>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pair</th>
<th>New Method (2)</th>
<th>Standard Method (1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>77</td>
<td>72</td>
</tr>
<tr class="even">
<td>2</td>
<td>74</td>
<td>68</td>
</tr>
<tr class="odd">
<td>3</td>
<td>82</td>
<td>76</td>
</tr>
<tr class="even">
<td>4</td>
<td>73</td>
<td>68</td>
</tr>
<tr class="odd">
<td>5</td>
<td>87</td>
<td>84</td>
</tr>
<tr class="even">
<td>6</td>
<td>69</td>
<td>68</td>
</tr>
<tr class="odd">
<td>7</td>
<td>66</td>
<td>61</td>
</tr>
<tr class="even">
<td>8</td>
<td>80</td>
<td>76</td>
</tr>
</tbody>
</table>
<p>Do the data support the hypothesis that the population mean reading test score for “slow learners” taught by the new method is greater than the mean reading test score for those taught by the standard method?</p>
<p>Using what you know so far, the hypotheses are <span class="math display">\[
\begin{align*}
    {H_0:\mu_1 = \mu_2}\\
    {H_a:\mu_1&lt;\mu_2}
\end{align*}
\]</span></p>
<p>Suppose we use the nonpooled t statistic for two independent samples to conduct this test and suppose both random samples come from approximately normal populations.</p>
<p>JMP output:</p>
<p><img src="images/10_01_reading_ind_ttest.png" class="img-fluid"></p>
<p>The p-value is <span class="math display">\[
\begin{align*}
   {P(T&lt;-1.256)=0.1149}
\end{align*}
\]</span></p>
<p>At <span class="math inline">\(\alpha=.1\)</span>, we would fail to reject <span class="math inline">\(H_0\)</span> and conclude that there is insufficient evidence to infer a difference in the mean test scores for the two methods.</p>
<p>Look at the data again in the table. You will see that the test score of the new method is larger than the corresponding test score for the standard method for every one of the eight pairs of “slow learners .”</p>
<p>This, in itself, seems to provide strong evidence to indicate that <span class="math inline">\(\mu_1&lt;\mu_2\)</span>.</p>
<p>Why, then, did the t -test fail to detect the difference?</p>
<p>The answer is, the <blank>independent</blank> samples t-test is not a valid procedure to use with this set of data.</p>
<p>We have randomly chosen <blank>pairs</blank> of test scores; thus, once we have chosen the sample for the new method, we have not independently chosen the sample for the standard method.</p>
<p>The dependence between observations within pairs can be seen by examining the pairs of test scores, which tend to rise and fall together as we go from pair to pair.</p>
<p>We now consider a valid method of analyzing the data. We can add a column for the differences between the test scores of the pairs of “slow learners.”</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 22%">
<col style="width: 29%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Pair</th>
<th>New Method (2)</th>
<th>Standard Method (1)</th>
<th>Difference (new - standard)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>77</td>
<td>72</td>
<td>5</td>
</tr>
<tr class="even">
<td>2</td>
<td>74</td>
<td>68</td>
<td>6</td>
</tr>
<tr class="odd">
<td>3</td>
<td>82</td>
<td>76</td>
<td>6</td>
</tr>
<tr class="even">
<td>4</td>
<td>73</td>
<td>68</td>
<td>5</td>
</tr>
<tr class="odd">
<td>5</td>
<td>87</td>
<td>84</td>
<td>3</td>
</tr>
<tr class="even">
<td>6</td>
<td>69</td>
<td>68</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>66</td>
<td>61</td>
<td>5</td>
</tr>
<tr class="even">
<td>8</td>
<td>80</td>
<td>76</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>When each subject or experimental unit provides <em>two related measurements</em>, such as before and after treatment or left‑ and right‑handed performance, we cannot treat the two samples as independent. Instead, we analyze the <blank>differences</blank> within pairs. The matched‑pairs t‑test focuses on the mean difference.</p>
<p><img src="images/13.png" class="img-fluid"></p>
<section id="setting-up-the-problem" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-problem">Setting up the problem</h3>
<p>Suppose we observe pairs <span class="math inline">\((x_{1i}, x_{2i})\)</span> for <span class="math inline">\(i=1,\dots,n\)</span>. Let <span class="math inline">\(d_i = x_{1i} - x_{2i}\)</span> denote the difference for each pair and let <span class="math inline">\(\bar{x}_x\)</span> and <span class="math inline">\(s_d\)</span> be the mean and standard deviation of the differences. To test whether the average difference <span class="math inline">\(\mu_d\)</span> equals zero, we formulate</p>
<p><span class="math display">\[
\begin{align*}
&amp;H_0: \mu_d = 0\\
&amp;H_a: \mu_d \neq 0\quad (\text{or } &gt; 0,&lt;0)
\end{align*}
\]</span></p>
</section>
<section id="matchedpairs-ttest" class="level3">
<h3 class="anchored" data-anchor-id="matchedpairs-ttest">Matched‑pairs t‑test</h3>
<p>The test statistic is</p>
<p><span class="math display">\[
t = \frac{\bar{x}_d}{s_d/\sqrt{n}}
\]</span></p>
<p>which follows a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n-1\)</span> degrees of freedom under <span class="math inline">\(H_0\)</span>. We compute the p‑value as before. A <span class="math inline">\((1-\alpha)\times100\%\)</span> confidence interval for <span class="math inline">\(\mu_d\)</span> is <span class="math inline">\(\bar{d} \pm t_{\alpha/2,n-1}\, s_d/\sqrt{n}\)</span>.</p>
<p>For our example, we have the following JMP output:</p>
<p><img src="images/10_02_reading_paired_ttest.png" class="img-fluid"></p>
<p>The p-value for this paired}t-test is <span class="math display">\[
\begin{align*}
    {P(T&lt;-7.344)&lt;0.0001}
\end{align*}
\]</span></p>
<section id="assumptions-1" class="level4">
<h4 class="anchored" data-anchor-id="assumptions-1">Assumptions</h4>
<ul>
<li>Observations are paired and differences <span class="math inline">\(d_i\)</span> are independent of one another.</li>
<li>The distribution of differences is approximately normal. If the number of pairs is small (<span class="math inline">\(n &lt; 30\)</span>) and the differences are skewed, the t‑test may not be reliable.</li>
</ul>
</section>
</section>
<section id="paired-t-test-in-jmp" class="level3">
<h3 class="anchored" data-anchor-id="paired-t-test-in-jmp">Paired t-test in JMP</h3>
<p>JMP users can perform the matched‑pairs t‑test by creating a column for the differences and following the one‑sample mean procedure. Alternatively, JMP provides a dedicated <strong>Matched Pairs</strong> command in the <code>Fit Y by X</code> platform: choose <code>Analyze → Fit Y by X</code>, assign the <em>after</em> measurement as Y, the <em>before</em> measurement as X, then click the red triangle and select <strong>Matched Pairs</strong>. JMP computes the difference column, reports the t‑statistic, and provides a confidence interval.</p>
</section>
<section id="recap-3" class="level3">
<h3 class="anchored" data-anchor-id="recap-3">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword/Concept</strong></th>
<th><strong>Definition/Formula</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Paired t‑test</strong></td>
<td>Tests <span class="math inline">\(H_0: \mu_d=0\)</span> using <span class="math inline">\(t=\bar{d}/(s_d/\sqrt{n})\)</span> with <span class="math inline">\(n-1\)</span> df.</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="check-your-understanding-3" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-3">Check your understanding</h3>
<ol type="1">
<li>A pharmaceutical company tests a new drug designed to lower systolic blood pressure. Ten volunteers have their blood pressure measured before and after taking the drug for a month. The differences (before – after) are: 8, 5, 10, 6, 12, 3, 9, 7, 11, 4 mmHg. Use the paired t‑test to determine whether the drug reduces blood pressure on average. Provide a 95% CI for the mean reduction.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Compute <span class="math inline">\(\bar{d}=7.5\)</span>, <span class="math inline">\(s_d=2.87\)</span> and <span class="math inline">\(n=10\)</span>. The t‑statistic is <span class="math inline">\(t=7.5/(2.87/\sqrt{10})\approx8.25\)</span> with 9 df. The two‑sided p‑value is <span class="math inline">\(&lt;0.0001\)</span>; we reject <span class="math inline">\(H_0\)</span> and conclude the drug lowers blood pressure. A 95% CI is <span class="math inline">\(7.5 \pm t_{0.025,9}\times2.87/\sqrt{10}=(6.0,9.0)\)</span> mmHg.</li>
</ol>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>