<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Continuous Probability Distributions – STA 2381 Introductory Statistical Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2ea2d3e7f2364fcda3d434693d3458e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style type="text/css">
.sidebar .chapter-number {
color: #FFB81c;
}
freeblank {
  color: transparent;
  cursor: pointer;
}
freeblank.clicked {
  color: red;
}
blank {
  display: inline-block; 
  position: relative;
  padding: 0 10px;
  color: transparent;
  cursor: pointer;
}
blank::before {
  content: ''; /* Creates a custom underline */
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 1px; /* Thickness of the underline */
  background-color: black; /* Color of the underline */
}
blank.clicked {
  color: red;
}
</style>
<script>
document.addEventListener('click', (event) => {
  if (event.target.tagName === 'BLANK') {
    event.target.classList.add('clicked');
  }
});
document.addEventListener('click', (event) => {
  if (event.target.tagName === 'FREEBLANK') {
    event.target.classList.add('clicked');
  }
});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Collecting Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Describing Data with Tables and Graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Describing Data with Numbers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sampling Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation and Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesis Testing: The Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis Testing with Categorical Response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Methods for Quantitative Response Variables – One and Two Groups</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Correlation and Simple Linear Regression</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-07_01" id="toc-sec-07_01" class="nav-link active" data-scroll-target="#sec-07_01"><span class="header-section-number">7.1</span> Continuous Probability Distributions and Their Properties</a>
  <ul class="collapse">
  <li><a href="#probability-distribution-for-continuous-random-variables" id="toc-probability-distribution-for-continuous-random-variables" class="nav-link" data-scroll-target="#probability-distribution-for-continuous-random-variables">Probability Distribution for Continuous Random Variables</a></li>
  <li><a href="#examples-from-biology-and-medicine" id="toc-examples-from-biology-and-medicine" class="nav-link" data-scroll-target="#examples-from-biology-and-medicine">Examples from biology and medicine</a></li>
  <li><a href="#mean-variance-and-standard-deviation-of-a-continuous-random-variable" id="toc-mean-variance-and-standard-deviation-of-a-continuous-random-variable" class="nav-link" data-scroll-target="#mean-variance-and-standard-deviation-of-a-continuous-random-variable">Mean, Variance, and Standard Deviation of a Continuous Random Variable</a></li>
  <li><a href="#working-in-jmp-pro-17" id="toc-working-in-jmp-pro-17" class="nav-link" data-scroll-target="#working-in-jmp-pro-17">Working in JMP Pro 17</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#check-your-understanding" id="toc-check-your-understanding" class="nav-link" data-scroll-target="#check-your-understanding">Check your understanding</a></li>
  </ul></li>
  <li><a href="#sec-07_02" id="toc-sec-07_02" class="nav-link" data-scroll-target="#sec-07_02"><span class="header-section-number">7.2</span> The Uniform Distribution</a>
  <ul class="collapse">
  <li><a href="#examples-from-medicine-and-biology" id="toc-examples-from-medicine-and-biology" class="nav-link" data-scroll-target="#examples-from-medicine-and-biology">Examples from medicine and biology</a></li>
  <li><a href="#working-in-jmp-pro-17-1" id="toc-working-in-jmp-pro-17-1" class="nav-link" data-scroll-target="#working-in-jmp-pro-17-1">Working in JMP Pro 17</a></li>
  <li><a href="#recap-1" id="toc-recap-1" class="nav-link" data-scroll-target="#recap-1">Recap</a></li>
  <li><a href="#check-your-understanding-1" id="toc-check-your-understanding-1" class="nav-link" data-scroll-target="#check-your-understanding-1">Check your understanding</a></li>
  </ul></li>
  <li><a href="#sec-07_03" id="toc-sec-07_03" class="nav-link" data-scroll-target="#sec-07_03"><span class="header-section-number">7.3</span> The Normal Distribution</a>
  <ul class="collapse">
  <li><a href="#examples-from-medicine-and-biology-1" id="toc-examples-from-medicine-and-biology-1" class="nav-link" data-scroll-target="#examples-from-medicine-and-biology-1">Examples from medicine and biology</a></li>
  <li><a href="#working-in-jmp-pro-17-2" id="toc-working-in-jmp-pro-17-2" class="nav-link" data-scroll-target="#working-in-jmp-pro-17-2">Working in JMP Pro 17</a></li>
  <li><a href="#recap-2" id="toc-recap-2" class="nav-link" data-scroll-target="#recap-2">Recap</a></li>
  <li><a href="#check-your-understanding-2" id="toc-check-your-understanding-2" class="nav-link" data-scroll-target="#check-your-understanding-2">Check your understanding</a></li>
  </ul></li>
  <li><a href="#sec-07_04" id="toc-sec-07_04" class="nav-link" data-scroll-target="#sec-07_04"><span class="header-section-number">7.4</span> Finding Probability for a Normal Distribution</a>
  <ul class="collapse">
  <li><a href="#stepbystep-procedure" id="toc-stepbystep-procedure" class="nav-link" data-scroll-target="#stepbystep-procedure">Step‑by‑step procedure</a></li>
  <li><a href="#example-antihypertensive-drug" id="toc-example-antihypertensive-drug" class="nav-link" data-scroll-target="#example-antihypertensive-drug">Example: antihypertensive drug</a></li>
  <li><a href="#working-in-jmp-pro-17-3" id="toc-working-in-jmp-pro-17-3" class="nav-link" data-scroll-target="#working-in-jmp-pro-17-3">Working in JMP Pro 17</a></li>
  <li><a href="#recap-3" id="toc-recap-3" class="nav-link" data-scroll-target="#recap-3">Recap</a></li>
  <li><a href="#check-your-understanding-3" id="toc-check-your-understanding-3" class="nav-link" data-scroll-target="#check-your-understanding-3">Check your understanding</a></li>
  </ul></li>
  <li><a href="#sec-07_05" id="toc-sec-07_05" class="nav-link" data-scroll-target="#sec-07_05"><span class="header-section-number">7.5</span> Finding a Quantile for a Normal Distribution</a>
  <ul class="collapse">
  <li><a href="#relationship-between-the-cdf-and-quantiles" id="toc-relationship-between-the-cdf-and-quantiles" class="nav-link" data-scroll-target="#relationship-between-the-cdf-and-quantiles">Relationship between the CDF and quantiles</a></li>
  <li><a href="#procedure-for-finding-quantiles" id="toc-procedure-for-finding-quantiles" class="nav-link" data-scroll-target="#procedure-for-finding-quantiles">Procedure for finding quantiles</a></li>
  <li><a href="#example-therapeutic-drug-monitoring" id="toc-example-therapeutic-drug-monitoring" class="nav-link" data-scroll-target="#example-therapeutic-drug-monitoring">Example: therapeutic drug monitoring</a></li>
  <li><a href="#working-in-jmp-pro-17-4" id="toc-working-in-jmp-pro-17-4" class="nav-link" data-scroll-target="#working-in-jmp-pro-17-4">Working in JMP Pro 17</a></li>
  <li><a href="#recap-4" id="toc-recap-4" class="nav-link" data-scroll-target="#recap-4">Recap</a></li>
  <li><a href="#check-your-understanding-4" id="toc-check-your-understanding-4" class="nav-link" data-scroll-target="#check-your-understanding-4">Check your understanding</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-07_01" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sec-07_01"><span class="header-section-number">7.1</span> Continuous Probability Distributions and Their Properties</h2>
<blockquote class="blockquote">
<p>“Statistics is the grammar of science.” – Karl Pearson</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>How do probability distributions work for continuous random variables?</em></p>
</blockquote>
<p>So far, we has focused on <em>discrete</em> outcomes: counts of patients, number of mutated alleles and so on. In those settings we could list the possible values, assign a probability to each one, and check that the probabilities summed to one. Many measurements in medicine and biology, however, can take <em>any value within a range</em> rather than a handful of distinct values. A person’s height could be 170.23 cm or 170.231 cm; the concentration of a hormone in blood plasma might be 2.7 or 2.701 ng/mL. When a random quantity can assume infinitely many values on an interval we call it a <blank>continuous random variable</blank>.</p>
<p>Because there are infinitely many possible values, we cannot find the probability that a continuous random variable takes <em>any exact value</em>. Instead of assigning probabilities to single points, we assign probabilities to <blank>intervals</blank>: the chance that a drug’s plasma concentration is between 2.5 and 3.5 ng/mL, for example.</p>
<section id="probability-distribution-for-continuous-random-variables" class="level3">
<h3 class="anchored" data-anchor-id="probability-distribution-for-continuous-random-variables">Probability Distribution for Continuous Random Variables</h3>
<p>Recall in Chapter 3, we discussed histograms in which the width of the bars is some interval of values and the height is either the frequency or relative frequency of the observations that fall in that interval. We could examine the relative frequency of the data that fall between any two value by adding the relative frequencies of the bars in that interval. For example, suppose we are looking for the relative frequency of the data shaded in the histogram below.</p>
<p><img src="images/06_02_histogram.png" class="img-fluid"></p>
<p>Thus, the area of these bars is the relative frequency in the interval of interest. In Chapter 5, we stated that we are using the relative frequency interpretation of probability. Therefore, the area shaded in the histogram will estimate the <blank>probability</blank> of the random variable being in that interval.</p>
<p>Now, let’s think of all of the possible data in the population. In this case, we can shrink the width of the bars to however small we wish. As we let the bar widths shrink to zero, then we end up with a smooth curve like below.</p>
<p><img src="images/06_03_smoothcurve.png" class="img-fluid"></p>
<p>The smooth curve (probability distribution of a continuous random variable) is denoted by the symbol <span class="math inline">\(f(x)\)</span> and is often called the <blank>probability density function</blank> (pdf). We can still view the area of the shaded region as the probability.</p>
<p>Because the area under the pdf represents probability, then by definition we have <span class="math display">\[
P(X=x)=0
\]</span> In other words, we assign a probability of zero at a point. This happens since there is no area under the curve at a point.</p>
<p>We do find the probability of a continuous random variable in an interval: <span class="math display">\[
P(a&lt; X&lt; b)
\]</span> How do we do this? We find the area <em>under the curve</em> between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. We find the area under the curve by taking the integral <span class="math display">\[
P(a &lt; X &lt; b) = \int_a^b f(x) \; dx.
\]</span></p>
<p>The <blank>cumulative distribution function</blank> (cdf) of <span class="math inline">\(X\)</span>, denoted <span class="math inline">\(F(x)\)</span>, gives the probability that <span class="math inline">\(X\)</span> is less than or equal to <span class="math inline">\(x\)</span>; it is the area under the density to the left of <span class="math inline">\(x\)</span>.</p>
<p>In summary:<br>
The probability distribution of a continuous random variable <span class="math inline">\(X\)</span> * is represented by a smooth curve * the curve is called the probability density function (pdf) * the probability <span class="math inline">\(P(a&lt;X&lt;b)=P(a\le X\le b)\)</span> is the area under the curve between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> * the cumulative distribution function (cdf) give the area to the left of some value: <span class="math inline">\(F(x)=P(X\le x)\)</span></p>
</section>
<section id="examples-from-biology-and-medicine" class="level3">
<h3 class="anchored" data-anchor-id="examples-from-biology-and-medicine">Examples from biology and medicine</h3>
<ul>
<li><p><strong>Drug metabolism.</strong> After an oral dose, the amount of a drug in the bloodstream rises and then falls over time. If we pick a random patient and record their peak plasma concentration, that value could be any number within a physiological range. The probability that the peak is <em>exactly</em> 3.000 µg/mL is zero; but we can talk meaningfully about the probability it lies between 2.8 and 3.2 µg/mL, which is the area under the density between those points.</p></li>
<li><p><strong>Plant heights.</strong> The height of a genetically identical group of plants grown under controlled conditions will vary due to micro‑environmental factors. Those heights are modeled as a continuous random variable. We might ask, for example, how likely it is for a plant to be taller than 15 cm; again, we look at the area under the density to the right of 15.</p></li>
</ul>
<p>When interpreting a pdf, remember that taller regions of the curve correspond to <em>higher likelihood density</em>, not to the probability of a specific value. Probability comes from the <em>area</em>, not the height at a point.</p>
</section>
<section id="mean-variance-and-standard-deviation-of-a-continuous-random-variable" class="level3">
<h3 class="anchored" data-anchor-id="mean-variance-and-standard-deviation-of-a-continuous-random-variable">Mean, Variance, and Standard Deviation of a Continuous Random Variable</h3>
<p>Recall that the mean of a discrete random variable is <span class="math display">\[
\mu = \sum_x xP(X=x)
\]</span></p>
<p>and the variance is <span class="math display">\[
\sigma^2= \sum_x (x-\mu)^2P(X=x)
\]</span></p>
<p>When working with continuous RVs, using the sum in the formulas above will not make any sense (since there are infinite number of value to sum over in any given interval).</p>
<p>Instead, we will use integration. The expected value for a continuous RV is <span class="math display">\[
{
\mu = \int_{-\infty}^{\infty}x f(x) dx
}
\]</span></p>
<p>and the variance is <span class="math display">\[
{
\sigma^2= \int_{-\infty}^{\infty} (x-\mu)^2f(x) dx
}
\]</span></p>
</section>
<section id="working-in-jmp-pro-17" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17">Working in JMP Pro 17</h3>
<p>JMP can help you explore continuous distributions experimentally. Here is a general workflow using an exponential example, but you can adapt it to other distributions:</p>
<ol type="1">
<li><strong>Simulate continuous data.</strong> Create a new data table and use <strong>Rows → Add Rows</strong> to add, say, 1 000 rows. Add a new column and choose <strong>Column → Formula</strong>. In the formula editor search for <code>Random Exponential(rate)</code> and specify a rate (e.g., <code>1/10</code>). Each cell will then contain a simulated lifetime.</li>
<li><strong>Visualize the distribution.</strong> Use <strong>Analyze → Distribution</strong> and select your simulated column. JMP produces a histogram and summary statistics. You can overlay a smooth density by clicking the red triangle ▸ next to the variable name and choosing <strong>Continuous Fit → Exponential</strong>.</li>
<li><strong>Compute probabilities.</strong> JMP’s distribution calculator (found under <strong>Add‑ins → Calculators → Distribution Calculator</strong> in JMP Pro 17) lets you choose a distribution, enter parameter values, and compute the probability that a continuous random variable lies between two values. For the exponential example, choose <strong>Exponential</strong>, set the rate, and enter the lower and upper bounds to find <span class="math inline">\(P(a ≤ X ≤ b)\)</span>.</li>
</ol>
</section>
<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>continuous random variable</strong></td>
<td>A random variable that can take any value in an interval; probabilities are assigned to ranges of values rather than individual points.</td>
</tr>
<tr class="even">
<td><strong>probability density function (PDF)</strong></td>
<td>A non‑negative function <span class="math inline">\(f(x)\)</span> such that <span class="math inline">\(P(a ≤ X ≤ b)\)</span> equals the area under <span class="math inline">\(f(x)\)</span> between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> and the total area under the curve of <span class="math inline">\(f(x)\)</span> is one.</td>
</tr>
<tr class="odd">
<td><strong>cumulative distribution function (CDF)</strong></td>
<td>The function <span class="math inline">\(F(x)=P(X ≤ x)\)</span> giving the area under the PDF to the left of <span class="math inline">\(x\)</span>. It increases from 0 to 1 as <span class="math inline">\(x\)</span> goes from <span class="math inline">\(-∞\)</span> to <span class="math inline">\(∞\)</span>.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding">Check your understanding</h3>
<ol type="1">
<li>Explain in your own words why the probability that a continuous random variable equals exactly 5 is zero. How, then, do we assign probabilities for continuous variables?</li>
<li>Sketch or describe the shape of a PDF that would model serum cholesterol levels in a population. Why can’t a PDF ever dip below the horizontal axis?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>A continuous random variable can take infinitely many values within any interval. Because the PDF spreads probability continuously across these values, the probability of landing on any single point is zero. We obtain meaningful probabilities by integrating the density over an interval to find the area under the curve between the limits.</li>
<li>Serum cholesterol tends to cluster around an average value with fewer extremely low or high values. A plausible PDF would be unimodal and right‑skewed: low near 0, rising to a peak near the typical cholesterol level, and gradually decreasing. The density must always stay at or above zero because probabilities cannot be negative.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-07_02" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sec-07_02"><span class="header-section-number">7.2</span> The Uniform Distribution</h2>
<blockquote class="blockquote">
<p>“Don’t mistake possibilities for probabilities. Anything is possible. It’s the probabilities that matter” – Ray Dalio</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>How does an equally likely continuous random variable work?</em></p>
</blockquote>
<p>The simplest continuous distribution is the <em>uniform distribution</em>. Imagine selecting a time uniformly at random within a two‑hour window; any minute in that window is just as likely as any other. More formally, a continuous random variable <span class="math inline">\(X\)</span> has a <em>Uniform<span class="math inline">\((c,d)\)</span></em> distribution if its PDF is constant on the interval <span class="math inline">\((c,d)\)</span> and zero elsewhere.</p>
<p>Since all values in the interval <span class="math inline">\((c,d)\)</span> are equally likely, the pdf of a uniform random variable appears as a horizontal line:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Note that the area under the curve must equal 1 (since the area corresponds to probability). Therefore, the area between <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span> <span class="math display">\[
\begin{align*}
    \text{area of rectangle} = \text{base}\times \text{height} &amp;\Longrightarrow{ 1 = (d-c) \times \text{height}}\\\\
    &amp;\Longrightarrow \text{height} = \frac{1}{d-c}
\end{align*}
\]</span></p>
<p>So, the pdf of a uniform random variable is <span class="math display">\[
f(x) = \frac{1}{d-c}
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The expected value is <span class="math display">\[
\begin{align*}
E(X)=\int_{c}^d xf(x)dx &amp;= \int_c^dx\left(\frac{1}{d-c}\right)dx\\
&amp; {= \left(\frac{1}{d-c}\right)\int_c^dxdx}\\
&amp; {= \left(\frac{1}{d-c}\right)\left(\frac{1}{2}\right)x^2\Big\vert^d_c} \\
&amp; {= \left(\frac{1}{d-c}\right)\left(\frac{1}{2}\right)\left(d^2-c^2\right)} \\
&amp; {= \left(\frac{1}{d-c}\right)\left(\frac{1}{2}\right)\left(d-c\right)\left(d+c\right)} \\
&amp; {= \frac{c+d}{2}}
\end{align*}
\]</span></p>
<p>We will not show the steps here but we could find the variance in a similar fashion to get <span class="math display">\[
\sigma^2 = \frac{\left(d-c\right)^2}{12}
\]</span> The standard deviation is then <span class="math display">\[
\sigma = \frac{\left(d-c\right)}{\sqrt{12}}
\]</span></p>
<p>For a uniform random variable <span class="math inline">\(X\)</span>, what is the probability <span class="math inline">\(P(a&lt;X&lt;b)\)</span>? <span class="math display">\[
\begin{align*}
    P(a&lt;X&lt;b)=\int_{a}^b f(x)dx &amp; = \int_{a}^b \frac{1}{d-c} dx\\
   &amp; {= \left(\frac{1}{d-c}\right)x\Big\vert_a^b}\\
    &amp;{= \left(\frac{b-a}{d-c}\right)}\\
\end{align*}
\]</span></p>
<p>Summary of Uniform RVs:</p>
<ul>
<li>the pdf is <span class="math inline">\(f(x)=\frac{1}{d-c}\qquad c\le X\le d\)</span></li>
<li>the mean is <span class="math inline">\(\mu = \frac{c+d}{2}\)</span> and the standard deviation is <span class="math inline">\(\sigma=\frac{d-c}{\sqrt{12}}\)</span></li>
<li><span class="math inline">\(P(a&lt;X&lt;b)=\frac{b-a}{d-c}\)</span></li>
</ul>
<section id="examples-from-medicine-and-biology" class="level3">
<h3 class="anchored" data-anchor-id="examples-from-medicine-and-biology">Examples from medicine and biology</h3>
<ul>
<li><p><strong>Patient arrival time.</strong> Suppose a clinic accepts blood samples from 8 am to 10 am and the phlebotomist expects donors to arrive at random. Let <span class="math inline">\(T\)</span> be the arrival time after 8 am (in hours). If arrivals are equally likely at any moment, <span class="math inline">\(T \sim \text{Uniform}(0,2)\)</span>. The probability that a randomly arriving donor comes between 8:30 and 9:00 am (i.e., <span class="math inline">\(0.5 ≤ T ≤ 1\)</span>) is <span class="math display">\[
\begin{align*}
P(0.5 ≤ T ≤ 1)=&amp;\frac{1-0.5}{2-0}\\
=&amp;0.25
\end{align*}
\]</span></p></li>
<li><p><strong>Randomized drug administration.</strong> In a study, participants are randomly assigned to take a dose of medication at any time between noon and 3 pm. The time of ingestion is Uniform<span class="math inline">\((0,3)\)</span> hours after noon. If we want the probability that a dose is taken in the first half‑hour, we compute <span class="math display">\[
\begin{align*}
P(0 ≤ T ≤ 0.5)=&amp;\frac{0.5-0}{3-0}\\
=&amp;0.167
\end{align*}
\]</span></p></li>
</ul>
</section>
<section id="working-in-jmp-pro-17-1" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17-1">Working in JMP Pro 17</h3>
<p>Uniform simulations are straightforward in JMP:</p>
<ol type="1">
<li><strong>Generate uniform random values.</strong> In a new data table, choose <strong>Rows → Add Rows</strong> to add your desired number of observations. Use <strong>Column → Formula</strong>, find the function <code>Random Uniform</code>, and specify the lower and upper bounds <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span>.</li>
<li><strong>Visualize and compute probabilities.</strong> Use <strong>Analyze → Distribution</strong> to produce a histogram. Since the density is flat, the histogram should approximate a rectangle when you use many bins. To compute <span class="math inline">\(P(a ≤ X ≤ b)\)</span> without simulation, use the distribution calculator: select <strong>Uniform</strong> from the list, enter <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span>, and set the lower and upper limits. JMP will report the probability <span class="math inline">\((b-a)/(d-c)\)</span>.</li>
</ol>
</section>
<section id="recap-1" class="level3">
<h3 class="anchored" data-anchor-id="recap-1">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>uniform distribution</strong></td>
<td>A continuous distribution on <span class="math inline">\((c,d)\)</span> whose PDF is constant at height <span class="math inline">\(1/(d-c)\)</span>. All intervals of equal length within <span class="math inline">\((c,d)\)</span> have equal probability.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding-1" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-1">Check your understanding</h3>
<ol type="1">
<li>Suppose <span class="math inline">\(X\sim\text{Uniform}(0,10)\)</span>. What is <span class="math inline">\(P(3 ≤ X ≤ 7)\)</span>? Explain your reasoning.</li>
<li>A researcher measures the pH of soil samples collected uniformly at random along a transect from 0 to 100 m. What is the probability that a randomly selected soil sample comes from between 20 m and 35 m? Express your answer numerically.</li>
<li>If <span class="math inline">\(Y\sim\text{Uniform}(c,d)\)</span> and you know that <span class="math inline">\(P(Y ≤ 5) = 0.5\)</span>, what relationship does this imply between <span class="math inline">\(c\)</span>, <span class="math inline">\(d\)</span> and 5?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>The interval from 3 to 7 has length 4. Since the distribution is Uniform<span class="math inline">\((0,10)\)</span>, the probability of any subinterval equals its length divided by the total length: <span class="math inline">\(4/10=0.4\)</span>.</li>
<li>The transect is 100 m long. The segment from 20 to 35 m is 15 m long, so <span class="math inline">\(P(20 ≤ X ≤ 35) = 15/100 = 0.15\)</span>.</li>
<li>For a uniform distribution, <span class="math inline">\(P(Y ≤ y) = (y-c)/(d-c)\)</span> for <span class="math inline">\(c ≤ y ≤ d\)</span>. Setting <span class="math inline">\(P(Y≤5)=0.5\)</span> implies <span class="math inline">\((5 - c)/(d - c) = 0.5\)</span>. Equivalently, <span class="math inline">\(5\)</span> is the midpoint of the interval and <span class="math inline">\(5 = (c + d)/2\)</span>.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-07_03" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="sec-07_03"><span class="header-section-number">7.3</span> The Normal Distribution</h2>
<blockquote class="blockquote">
<p>“the normal distribution is seldom, if ever, observed in nature.” – Louis Guttman</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>Why is the normal distribution so commonly used?</em></p>
</blockquote>
<p>The <blank>normal distribution</blank> (also called the <em>Gaussian distribution</em>) is the most celebrated continuous distribution in statistics. It is the foundation for much of statistical inference.</p>
<p>A <span class="math inline">\(N(\mu,\sigma)\)</span> distribution is symmetric, bell‑shaped and centered at its mean <span class="math inline">\(\mu\)</span>. In a normal distribution, the mean, median and mode all coincide, and the curve extends infinitely in both directions. The two parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> control the center and spread of the distribution:</p>
<ul>
<li><span class="math inline">\(\mu\)</span> is the location of the peak and</li>
<li><span class="math inline">\(\sigma\)</span> measures the standard deviation (the “width” of the bell).</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The density function of a <span class="math inline">\(N(\mu,\sigma)\)</span> random variable can be written as</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sigma\sqrt{2\pi}} \exp\left( - \frac{1}{2\sigma^2}(x - \mu)^2 \right).
\]</span></p>
<p>You do not need to memorize this formula to use the normal model. More important are its qualitative properties: it is unimodal, symmetric, and tails off smoothly; the total area under the curve is one.</p>
<section id="examples-from-medicine-and-biology-1" class="level3">
<h3 class="anchored" data-anchor-id="examples-from-medicine-and-biology-1">Examples from medicine and biology</h3>
<ul>
<li><p><strong>Adult heights.</strong> Within a homogeneous population, adult heights tend to cluster around an average and taper off symmetrically. For example, men’s heights might follow a <span class="math inline">\(N(175,7)\)</span>. Values far below 175 cm or far above are increasingly rare.</p></li>
<li><p><strong>Gene expression levels.</strong> In microarray experiments, the log‑transformed expression levels of many genes approximate normality. This allows researchers to use statistical tests that assume normally distributed data.</p></li>
</ul>
<!-- #### Visualizing the normal curve -->
<!-- The plot below shows the standard normal density (mean 0, standard deviation 1) along with vertical lines at $\mu \pm \sigma$ and $\mu \pm 2\sigma$ to illustrate the 68–95 rule. -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| message: false -->
<!-- #| warning: false -->
<!-- library(tidyverse) -->
<!-- ggplot(data.frame(x = c(-4, 4)), aes(x)) + -->
<!--   stat_function(fun = dnorm, args = list(mean = 0, sd = 1), colour = "#2c7fb8", size = 1) + -->
<!--   geom_vline(xintercept = c(-1, 1), linetype = "dashed", colour = "#e6550d") + -->
<!--   geom_vline(xintercept = c(-2, 2), linetype = "dotted", colour = "#31a354") + -->
<!--   labs(x = "z", y = "Density", title = "Standard normal density with one- and two-standard-deviation markers") + -->
<!--   annotate("text", x = 0, y = 0.35, label = "68% between -1 and 1", colour = "#e6550d", hjust = 0.5) + -->
<!--   annotate("text", x = 0, y = 0.3, label = "95% between -2 and 2", colour = "#31a354", hjust = 0.5) + -->
<!--   theme_minimal() -->
<!-- ``` -->
</section>
<section id="working-in-jmp-pro-17-2" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17-2">Working in JMP Pro 17</h3>
<p>To explore normal distributions in JMP:</p>
<ol type="1">
<li><strong>Simulate normal data.</strong> Create a new column with <strong>Column → Formula</strong> and use <code>Random Normal(µ, σ)</code> to generate values. For example, <code>Random Normal(175,7)</code> will simulate heights in centimetres with mean 175 and standard deviation 7.</li>
<li><strong>Visualise the distribution.</strong> Use <strong>Analyze → Distribution</strong> to generate a histogram and overlay a fitted normal curve. Click the red triangle ▸ next to the variable and choose <strong>Continuous Fit → Normal</strong>. JMP displays parameter estimates and a density overlay.</li>
</ol>
</section>
<section id="recap-2" class="level3">
<h3 class="anchored" data-anchor-id="recap-2">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>normal distribution</strong></td>
<td>A continuous, symmetric bell‑shaped distribution defined by its mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>; mean = median = mode.</td>
</tr>
<tr class="even">
<td><strong>standard normal distribution</strong></td>
<td>The special case Normal<span class="math inline">\((0,1)\)</span>; its values are often called <em>z‑scores</em>, and any normal distribution can be standardized via <span class="math inline">\(z = (x - \mu)/\sigma\)</span>.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding-2" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-2">Check your understanding</h3>
<ol type="1">
<li>What does it mean that the mean, median and mode of a normal distribution are equal? How is this reflected in the shape of the curve?</li>
<li>For a <span class="math inline">\(N(150,20)\)</span> distribution (representing, say, birth weights in grams), approximately what percentage of babies weigh between 110 g and 190 g?</li>
<li>Explain why extreme values (more than 3 standard deviations from the mean) are considered unusual under the normal model.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>A normal curve is perfectly symmetric about its mean; the highest point occurs at <span class="math inline">\(\mu\)</span> and the curve declines equally on both sides. Because of this symmetry, the most typical value (the mode), the point dividing the distribution in half (the median) and the arithmetic average (the mean) coincide.</li>
<li>Two standard deviations on either side of the mean cover about 95% of the data. The interval from <span class="math inline">\(\mu-2\sigma = 150 - 40 = 110\)</span> to <span class="math inline">\(\mu+2\sigma = 190\)</span> therefore captures roughly 95% of birth weights.</li>
<li>Under the normal model, only about 0.3% of observations lie beyond three standard deviations from the mean by the empirical rule. Thus values outside that range are rare and often signal measurement error or a departure from normality.</li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-07_04" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="sec-07_04"><span class="header-section-number">7.4</span> Finding Probability for a Normal Distribution</h2>
<blockquote class="blockquote">
<p>“I once worked with a guy for three years and never learned his name. Best friend I ever had. We still never talk sometimes.” -Ron Swanson</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>How can we find probabilities using the normal model?</em></p>
</blockquote>
<p>Once we determine the normal model for a variable, we can compute probabilities by standardizing the variable to a <blank>z‑score</blank>. Given <span class="math inline">\(X\sim N(\mu,\sigma)\)</span>, the z‑score corresponding to a value <span class="math inline">\(x\)</span> is</p>
<p><span class="math display">\[
z = \frac{x - \mu}{\sigma}.
\]</span></p>
<p>This transformation rescales and recenters <span class="math inline">\(X\)</span> so that <span class="math inline">\(Z \sim N(0,1)\)</span>. We then look up the area under the standard normal curve up to <span class="math inline">\(z\)</span> (or beyond) using tables, software or JMP. Because the normal distribution is continuous, we always compute probabilities for intervals, not exact points.</p>
<section id="stepbystep-procedure" class="level3">
<h3 class="anchored" data-anchor-id="stepbystep-procedure">Step‑by‑step procedure</h3>
<ol type="1">
<li><strong>State the distribution.</strong> Identify <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> for your normal variable.</li>
<li><strong>Draw a sketch.</strong> Label the mean and the point(s) of interest on a bell curve. Shading the region corresponding to the probability helps visualize whether you need the area to the left, right or between two points.</li>
<li><strong>Compute z‑scores.</strong> For each boundary <span class="math inline">\(x\)</span> compute <span class="math inline">\(z=(x-\mu)/\sigma\)</span>.</li>
<li><strong>Use a table or software.</strong> For the standard normal distribution, tables give <span class="math inline">\(P(Z ≤ z)\)</span> for many <span class="math inline">\(z\)</span> values. For probabilities of the form <span class="math inline">\(P(X ≥ x)\)</span> or <span class="math inline">\(P(a ≤ X ≤ b)\)</span>, convert to z‑scores and use the fact that <span class="math inline">\(P(Z &gt; z) = 1 - P(Z ≤ z)\)</span> and <span class="math inline">\(P(a ≤ X ≤ b) = P(z_a ≤ Z ≤ z_b)\)</span>.</li>
<li><strong>Interpret in context.</strong> State your answer in terms of the original problem.</li>
</ol>
</section>
<section id="example-antihypertensive-drug" class="level3">
<h3 class="anchored" data-anchor-id="example-antihypertensive-drug">Example: antihypertensive drug</h3>
<p>Suppose the reduction in systolic blood pressure (SBP) after taking a new antihypertensive follows a <span class="math inline">\(N(10,4)\)</span> distribution. What is the probability that a randomly treated patient experiences a reduction of at least 15 mm Hg?</p>
<p>Let <span class="math inline">\(X\)</span> be the reduction in SBP. We want <span class="math inline">\(P(X ≥ 15)\)</span>.</p>
<ol type="1">
<li><strong>Compute the z‑score.</strong></li>
</ol>
<p><span class="math display">\[
z=\frac{15-10}{4}=1.25
\]</span></p>
<ol start="2" type="1">
<li><strong>Find the area to the right.</strong> Using the Normal Probability Calculator in JMP 18 Student Edition (Student → Applets → Distribution Calculator):</li>
</ol>
<p><img src="images/normal1.png" class="img-fluid"></p>
<p>From this calculator we have: <span class="math display">\[
P(Z ≥ 1.25)=0.1056
\]</span></p>
<p>Using the Normal Calculator also allows us to find the probability without taking a z-score first. We just need to change the values of Mean and Std. Dev. in the applet.</p>
<p><img src="images/normal2.png" class="img-fluid"></p>
<ol start="3" type="1">
<li><strong>Interpretation.</strong> About 10.6% of patients have a reduction of at least 15 mm Hg.</li>
</ol>
</section>
<section id="working-in-jmp-pro-17-3" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17-3">Working in JMP Pro 17</h3>
<p>JMP’s distribution calculator makes these computations straightforward:</p>
<ol type="1">
<li><strong>Open the distribution calculator.</strong> In JMP Pro 17 go to <strong>Add‑ins → Calculators → Distribution Calculator</strong>. Choose <strong>Normal</strong> from the list of distributions.</li>
<li><strong>Enter parameters.</strong> Enter the mean and standard deviation (e.g., 10 and 4) and specify whether you want the area <strong>Left</strong>, <strong>Right</strong> or <strong>Between</strong> two values. For a “greater than” probability like <span class="math inline">\(P(X ≥ 15)\)</span>, choose <strong>Right</strong> and enter 15. JMP will display the area to the right.</li>
<li><strong>Visual check.</strong> The calculator shows a graph of the normal curve with the relevant region shaded. Use this to verify that you selected the correct tail or interval.</li>
</ol>
</section>
<section id="recap-3" class="level3">
<h3 class="anchored" data-anchor-id="recap-3">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>z‑score</strong></td>
<td>The number of standard deviations a value <span class="math inline">\(x\)</span> is from the mean: <span class="math inline">\(z=(x-\mu)/\sigma\)</span>. Converting to z‑scores allows probabilities from any normal distribution to be found using the standard normal distribution.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding-3" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-3">Check your understanding</h3>
<ol type="1">
<li>Cholesterol reductions after a dietary intervention follow a <span class="math inline">\(N(20,5)\)</span> distribution. What is the probability that a randomly selected participant’s reduction is less than 12 mg/dL? Show the z‑score and compute the probability.</li>
<li>Serum calcium levels in a normal population have mean 9.5 mg/dL and standard deviation 0.4 mg/dL. What proportion of individuals have calcium levels between 9.1 and 9.9 mg/dL? Sketch the problem and find the probability.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Compute <span class="math inline">\(z=(12-20)/5=-1.6\)</span>. From a standard normal table, <span class="math inline">\(P(Z ≤ -1.6)\approx0.0548\)</span>. Therefore <span class="math inline">\(P(X ≤ 12)=0.0548\)</span>.</li>
<li>First convert the endpoints to z‑scores: <span class="math inline">\(z_1=(9.1-9.5)/0.4=-1.0\)</span> and <span class="math inline">\(z_2=(9.9-9.5)/0.4=1.0\)</span>. Using the calculator, we have <span class="math inline">\(P(-1\le Z \le 1)=0.6827\)</span></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-07_05" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="sec-07_05"><span class="header-section-number">7.5</span> Finding a Quantile for a Normal Distribution</h2>
<blockquote class="blockquote">
<p>“Two things are infinite: the universe and human stupidity; and I’m not sure about the universe.” – Albert Einstein</p>
</blockquote>
<blockquote class="blockquote">
<p><em>Guiding question:</em> <em>How can we find quantiles using the normal model?</em></p>
</blockquote>
<p>In many applications we know a desired probability and wish to find the corresponding value of <span class="math inline">\(x\)</span> such that <span class="math inline">\(P(X ≤ x)=p\)</span>. This value is called a <blank>quantile</blank> or <blank>percentile</blank> of the distribution. Mathematically, the quantile function <span class="math inline">\(F^{-1}(p)\)</span> is the inverse of the cumulative distribution function. For a normal distribution, the quantile function returns the <span class="math inline">\(x\)</span> value whose cumulative probability is <span class="math inline">\(p\)</span>.</p>
<section id="relationship-between-the-cdf-and-quantiles" class="level3">
<h3 class="anchored" data-anchor-id="relationship-between-the-cdf-and-quantiles">Relationship between the CDF and quantiles</h3>
<p>The cumulative distribution function <span class="math inline">\(F(x)\)</span> gives the probability that a random variable <span class="math inline">\(X\)</span> is less than or equal to <span class="math inline">\(x\)</span>. The quantile function does the reverse: it takes a probability <span class="math inline">\(p\)</span> and returns the threshold <span class="math inline">\(x\)</span> such that <span class="math inline">\(P(X ≤ x)=p\)</span>. For example, the 0.5 quantile is the median. Because the normal CDF does not have a simple algebraic inverse, quantiles are typically obtained from tables or software.</p>
<p>At times, there are special quantiles that will show up in statistical methods that we will discuss later. We denote these as <span class="math display">\[
p = P(Z&gt; z_p)
\]</span> In other words, <span class="math inline">\(z_p\)</span> is the value of the standard normal distribution that will have <span class="math inline">\(p\)</span> area to the right. For example, <span class="math inline">\(z_{0.05}\)</span> is the value that has 0.05 area to the right.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Here the value is <span class="math display">\[
z_{0.05}=1.645
\]</span></p>
</section>
<section id="procedure-for-finding-quantiles" class="level3">
<h3 class="anchored" data-anchor-id="procedure-for-finding-quantiles">Procedure for finding quantiles</h3>
<ol type="1">
<li><em>Specify the probability <span class="math inline">\(p\)</span>.</em> Decide whether you want a lower tail (left‑side) quantile (e.g., the 5th percentile) or a two‑sided bound, or an upper tail area.</li>
<li><em>Find the corresponding z‑score.</em> For the standard normal distribution, tables and software can give you the quantile.</li>
<li><strong>Transform back to <span class="math inline">\(x\)</span>.</strong> If <span class="math inline">\(X\sim N(\mu,\sigma)\)</span>, then <span class="math inline">\(x=\mu + z\sigma\)</span> gives the desired quantile. Some software can find the quantile right from <span class="math inline">\(x\)</span>. In which case, there is no need to find the value for <span class="math inline">\(z\)</span>-score first.</li>
</ol>
</section>
<section id="example-therapeutic-drug-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="example-therapeutic-drug-monitoring">Example: therapeutic drug monitoring</h3>
<p>Suppose therapeutic blood levels of a drug after dosing follow a <span class="math inline">\(N(50,10)\)</span> distribution. Physicians want to define the <em>upper control limit</em> beyond which a concentration is considered dangerously high. If they choose the 97.5th percentile as the cut‑off, what value should they use?</p>
<ol type="1">
<li><em>Find the 97.5th percentile for <span class="math inline">\(z\)</span>.</em> Using the special quantile location, this would be <span class="math inline">\(z_{0.025}\)</span>. Using the Normal Probability Calculator in JMP 18 Student Edition (Student → Applets → Distribution Calculator): <img src="images/invnorm1.png" class="img-fluid"></li>
<li><em>Transform back.</em><br>
<span class="math display">\[
\begin{align*}
x=&amp;\mu + z\sigma\\
=&amp; 50 + 1.96\times10\\
=&amp; 69.6
\end{align*}
\]</span></li>
<li><em>Interpretation.</em> Only 2.5% of patients are expected to have concentrations above 69.6 ng/mL. Concentrations exceeding this threshold may warrant intervention.</li>
</ol>
</section>
<section id="working-in-jmp-pro-17-4" class="level3">
<h3 class="anchored" data-anchor-id="working-in-jmp-pro-17-4">Working in JMP Pro 17</h3>
<p>To find quantiles in JMP:</p>
<ol type="1">
<li><strong>Use the distribution calculator.</strong> Open the distribution calculator and select <strong>Normal</strong>. Switch to the <strong>Percentile</strong> (or <strong>Inverse</strong>) mode. Enter the probability <span class="math inline">\(p\)</span> (e.g., 0.975) and the distribution parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. JMP returns the corresponding <span class="math inline">\(x\)</span> value.</li>
<li><strong>Check with the CDF.</strong> You can verify your result by switching back to the probability mode and entering the value <span class="math inline">\(x\)</span> you found. The calculator should return <span class="math inline">\(p\)</span>.</li>
</ol>
</section>
<section id="recap-4" class="level3">
<h3 class="anchored" data-anchor-id="recap-4">Recap</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Keyword</strong></th>
<th><strong>Definition</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>quantile (percentile)</strong></td>
<td>For a continuous distribution with CDF <span class="math inline">\(F\)</span>, the value <span class="math inline">\(x=F^{-1}(p)\)</span> such that <span class="math inline">\(P(X ≤ x)=p\)</span>.</td>
</tr>
</tbody>
</table>
</section>
<section id="check-your-understanding-4" class="level3">
<h3 class="anchored" data-anchor-id="check-your-understanding-4">Check your understanding</h3>
<ol type="1">
<li>Birth weights in a population follow a <span class="math inline">\(zn(3.5,0.4)\)</span> distribution. What is the weight corresponding to the 90th percentile? Show your calculation.</li>
<li>An assay has measurement errors that are <span class="math inline">\(N(0,2)\)</span> distributed. What cut‑off defines the central 80% of the error distribution (i.e., the range from the 10th to the 90th percentile)?</li>
<li>Explain the relationship between the CDF and the quantile function in your own words. Why do we need tables or software to find quantiles for the normal distribution?</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="Solutions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>First find the z‑score <span class="math inline">\(z_{0.10}\approx1.2816\)</span>. Then <span class="math inline">\(x=3.5 + 1.2816\times0.4 = 4.0126\)</span> kg. Therefore, about 10% of babies weigh more than approximately 4.0 kg.</li>
<li>The central 80% corresponds to the interval between the 10th and 90th percentiles. From a standard normal table <span class="math inline">\(z_{0.90}\approx-1.2816\)</span> and <span class="math inline">\(z_{0.10}\approx1.2816\)</span>. Multiply by <span class="math inline">\(\sigma=2\)</span> and add the mean 0: the interval is from <span class="math inline">\(-1.2816×2≈-2.5632\)</span> to <span class="math inline">\(1.2816×2≈2.5632\)</span>.</li>
<li>The CDF gives the probability that a random variable is less than or equal to <span class="math inline">\(x\)</span>. The quantile function reverses this: given a probability <span class="math inline">\(p\)</span>, it returns the <span class="math inline">\(x\)</span> for which the CDF equals <span class="math inline">\(p\)</span>. The normal CDF has no simple algebraic inverse, so we rely on tables or software to compute quantiles.</li>
</ol>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>